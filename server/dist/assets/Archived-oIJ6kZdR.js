import{u as y,i as g,k as w,r as x,m as N,af as c,j as e,I as f}from"./index-wLWO9-d2.js";import{s as v}from"./CommonDialog-ZOWzLRrT.js";import{E as M}from"./Empty-ltZlBdUA.js";import{a as S,M as b}from"./useDebounce-KloUpVAw.js";import{u as C,M as k}from"./useFilterWithUrlParams-ebCQAYQq.js";import{M as T}from"./MobileHeader-d_EUlUPT.js";import{S as E}from"./SearchBar-9pRpIKu1.js";import{u as R}from"./useLoading-1GM5JUMl.js";import{R as A}from"./common-logcmh1j.js";import{T as u}from"./useResponsiveWidth-huLhTKBL.js";import"./last-IOi7af79.js";import"./Button-Y8r740D0.js";import"./ResourceIcon-rz_9chuf.js";import"./Divider-PmcpRuGM.js";import"./Checkbox-4xG-yJfH.js";import"./createSvgIcon-LnoQSaos.js";import"./Typography-Ugz7CGU8.js";import"./useControlled-c04xw6hS.js";const K=()=>{const r=y(),n=R(),p=g(),m=w(),[d,i]=x.useState([]),{tag:l,text:o}=C();x.useEffect(()=>{(async()=>{try{const t=[`creator == "${p.name}"`,"row_status == 'ARCHIVED'"],s=[];l&&s.push(JSON.stringify(`#${l}`)),o&&s.push(JSON.stringify(o)),s.length>0&&t.push(`content_search == [${s.join(", ")}]`);const{memos:a}=await N.listMemos({filter:t.join(" && ")});i(a)}catch(t){c.error(t.details)}n.setFinish()})()},[l,o]);const h=async t=>{v({title:r("memo.delete-memo"),content:r("memo.delete-confirm"),style:"danger",dialogName:"delete-memo-dialog",onConfirm:async()=>{await m.deleteMemo(t.id),i(s=>s.filter(a=>a.id!==t.id))}})},j=async t=>{try{await m.updateMemo({id:t.id,rowStatus:A.ACTIVE},["row_status"]),i(s=>s.filter(a=>a.id!==t.id)),c(r("message.restored-successfully"))}catch(s){console.error(s),c.error(s.details)}};return e.jsxs("section",{className:"@container w-full max-w-5xl min-h-full flex flex-col justify-start items-start sm:pt-3 md:pt-6 pb-8",children:[e.jsx(T,{}),e.jsx("div",{className:"w-full px-4 sm:px-6",children:e.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[e.jsx("div",{className:"w-full flex flex-row justify-end items-center mb-2",children:e.jsx("div",{className:"w-40",children:e.jsx(E,{})})}),e.jsx(k,{className:"px-2 pb-2"}),n.isLoading?e.jsx("div",{className:"w-full h-32 flex flex-col justify-center items-center",children:e.jsx("p",{className:"opacity-70",children:r("memo.fetching-data")})}):d.length===0?e.jsxs("div",{className:"w-full mt-16 mb-8 flex flex-col justify-center items-center italic",children:[e.jsx(M,{}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:r("message.no-data")})]}):d.map(t=>e.jsxs("div",{className:"relative flex flex-col justify-start items-start w-full p-4 pt-3 mb-2 bg-white dark:bg-zinc-800 rounded-lg",children:[e.jsxs("div",{className:"w-full mb-1 flex flex-row justify-between items-center",children:[e.jsx("div",{className:"w-full max-w-[calc(100%-20px)] flex flex-row justify-start items-center mr-1",children:e.jsx("span",{className:"text-sm text-gray-400 select-none",children:S(t.updateTime)})}),e.jsxs("div",{className:"flex flex-row justify-end items-center gap-x-2",children:[e.jsx(u,{title:r("common.restore"),placement:"top",children:e.jsx("button",{onClick:()=>j(t),children:e.jsx(f.ArchiveRestore,{className:"w-4 h-auto cursor-pointer text-gray-500 dark:text-gray-400"})})}),e.jsx(u,{title:r("common.delete"),placement:"top",children:e.jsx("button",{onClick:()=>h(t),className:"text-gray-500 dark:text-gray-400",children:e.jsx(f.Trash,{className:"w-4 h-auto cursor-pointer"})})})]})]}),e.jsx(b,{memoId:t.id,content:t.content,readonly:!0},`${t.id}-${t.updateTime}`)]},t.id))]})})]})};export{K as default};
