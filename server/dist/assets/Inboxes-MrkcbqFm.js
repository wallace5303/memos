import{u as N,a as A,z as b,k as M,r as f,aJ as k,j as e,A as a,I as p,q as U,af as j,aK as E}from"./index-wLWO9-d2.js";import{E as C}from"./Empty-ltZlBdUA.js";import{c as y,T as v}from"./useResponsiveWidth-huLhTKBL.js";import{M as S}from"./MobileHeader-d_EUlUPT.js";import"./Button-Y8r740D0.js";import"./useControlled-c04xw6hS.js";const T=({inbox:t})=>{var d,r,u;const o=N(),c=A(),s=b(),n=M(),[i,h]=f.useState(void 0);f.useEffect(()=>{t.activityId&&k.getActivity({id:t.activityId}).then(({activity:l})=>{h(l)})},[t.activityId]);const g=async()=>{var w,I;const l=(I=(w=i==null?void 0:i.payload)==null?void 0:w.memoComment)==null?void 0:I.relatedMemoId;if(!l)return;const x=await n.getOrFetchMemoById(l);if(!x){j.error("Memo not found");return}c(`/m/${x.name}`),t.status===a.UNREAD&&m(!0)},m=async(l=!1)=>{await s.updateInbox({name:t.name,status:a.ARCHIVED},["status"]),l||j.success("Archived")};return e.jsxs("div",{className:"w-full flex flex-row justify-start items-start gap-3",children:[e.jsx("div",{className:y("shrink-0 mt-2 p-2 rounded-full border",t.status===a.UNREAD?"border-blue-600 text-blue-600 bg-blue-50 dark:bg-zinc-800":"border-gray-500 text-gray-500 bg-gray-50 dark:bg-zinc-800"),children:e.jsx(v,{title:"Comment",placement:"bottom",children:e.jsx(p.MessageCircle,{className:"w-4 sm:w-5 h-auto"})})}),e.jsxs("div",{className:y("border w-full p-3 px-4 rounded-lg flex flex-col justify-start items-start gap-2 dark:border-zinc-700 hover:bg-gray-100 dark:hover:bg-zinc-700",t.status!==a.UNREAD&&"opacity-60"),children:[e.jsxs("div",{className:"w-full flex flex-row justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500",children:(d=t.createTime)==null?void 0:d.toLocaleString()}),e.jsx("div",{children:t.status===a.UNREAD&&e.jsx(v,{title:o("common.archive"),placement:"top",children:e.jsx(p.Inbox,{className:"w-4 h-auto cursor-pointer text-gray-400 hover:text-blue-600",onClick:()=>m()})})})]}),e.jsx("p",{className:"text-base leading-tight cursor-pointer text-gray-500 dark:text-gray-400 hover:underline hover:text-blue-600",onClick:g,children:o("inbox.memo-comment",{user:U(t.sender),memo:`memo#${(u=(r=i==null?void 0:i.payload)==null?void 0:r.memoComment)==null?void 0:u.relatedMemoId}`})})]})]})},R=({inbox:t})=>{var g,m,d;const o=N(),c=b(),[s,n]=f.useState(void 0);f.useEffect(()=>{t.activityId&&k.getActivity({id:t.activityId}).then(({activity:r})=>{n(r)})},[t.activityId]);const i=()=>{var r,u,l,x;(u=(r=s==null?void 0:s.payload)==null?void 0:r.versionUpdate)!=null&&u.version&&(window.open(`https://github.com/usememos/memos/releases/tag/v${(x=(l=s==null?void 0:s.payload)==null?void 0:l.versionUpdate)==null?void 0:x.version}`),t.status===a.UNREAD&&h(!0))},h=async(r=!1)=>{await c.updateInbox({name:t.name,status:a.ARCHIVED},["status"]),r||j.success("Archived")};return e.jsxs("div",{className:"w-full flex flex-row justify-start items-start gap-3",children:[e.jsx("div",{className:y("shrink-0 mt-2 p-2 rounded-full border",t.status===a.UNREAD?"border-blue-600 text-blue-600 bg-blue-50 dark:bg-zinc-800":"border-gray-500 text-gray-500 bg-gray-50 dark:bg-zinc-800"),children:e.jsx(v,{title:"Update",placement:"bottom",children:e.jsx(p.ArrowUp,{className:"w-4 sm:w-5 h-auto"})})}),e.jsxs("div",{className:y("border w-full p-3 px-4 rounded-lg flex flex-col justify-start items-start gap-2 dark:border-zinc-700 hover:bg-gray-100 dark:hover:bg-zinc-700",t.status!==a.UNREAD&&"opacity-60"),children:[e.jsxs("div",{className:"w-full flex flex-row justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500",children:(g=t.createTime)==null?void 0:g.toLocaleString()}),e.jsx("div",{children:t.status===a.UNREAD&&e.jsx(v,{title:o("common.archive"),placement:"top",children:e.jsx(p.Inbox,{className:"w-4 h-auto cursor-pointer text-gray-400 hover:text-blue-600",onClick:()=>h()})})})]}),e.jsx("p",{className:"text-base leading-tight cursor-pointer text-gray-500 dark:text-gray-400 hover:underline hover:text-blue-600",onClick:i,children:o("inbox.version-update",{version:(d=(m=s==null?void 0:s.payload)==null?void 0:m.versionUpdate)==null?void 0:d.version})})]})]})},H=()=>{const t=N(),o=b(),c=o.inboxes.sort((s,n)=>s.status-n.status);return f.useEffect(()=>{o.fetchInboxes()},[]),e.jsxs("section",{className:"@container w-full max-w-5xl min-h-full flex flex-col justify-start items-center sm:pt-3 md:pt-6 pb-8",children:[e.jsx(S,{}),e.jsx("div",{className:"w-full px-4 sm:px-6",children:e.jsxs("div",{className:"w-full shadow flex flex-col justify-start items-start px-4 py-3 rounded-xl bg-white dark:bg-zinc-800 text-black dark:text-gray-300",children:[e.jsx("div",{className:"relative w-full flex flex-row justify-between items-center",children:e.jsxs("p",{className:"py-1 flex flex-row justify-start items-center select-none opacity-80",children:[e.jsx(p.Bell,{className:"w-6 h-auto mr-1 opacity-80"}),e.jsx("span",{className:"text-lg",children:t("common.inbox")})]})}),e.jsxs("div",{className:"w-full h-auto flex flex-col justify-start items-start px-2 pb-4",children:[c.length===0&&e.jsxs("div",{className:"w-full mt-4 mb-8 flex flex-col justify-center items-center italic",children:[e.jsx(C,{}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:t("message.no-data")})]}),e.jsx("div",{className:"flex flex-col justify-start items-start w-full mt-4 gap-4",children:c.map(s=>{if(s.type===E.TYPE_MEMO_COMMENT)return e.jsx(T,{inbox:s},`${s.name}-${s.status}`);if(s.type===E.TYPE_VERSION_UPDATE)return e.jsx(R,{inbox:s},`${s.name}-${s.status}`)})})]})]})})]})};export{H as default};
