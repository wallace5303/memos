import{r as p,_ as N,j as t,v as nt,s as at,w as Ee,x as ue,a6 as So,i as Yt,a7 as Se,t as yt,a8 as ar,a9 as io,aa as ir,u as ze,b as Qt,ab as lo,ac as co,ad as lr,ae as cr,k as Ge,n as xe,I as M,m as He,af as No,ag as dr,M as Je,y as ur,ah as Ro,c as Zt,V as We,ai as pr,aj as mr,d as qt,q as rt,ak as uo,a as fr}from"./index-wLWO9-d2.js";import{e as Ct,S as eo,I as we,D as Lo,M as Do,a as To,b as _t,d as hr,T as qe,c as wt,U as Po}from"./useResponsiveWidth-huLhTKBL.js";import{c as Oo,R as gr}from"./common-logcmh1j.js";import{g as Xe,D as xr,U as Ke,T as po,s as vr}from"./CommonDialog-ZOWzLRrT.js";import{c as mo,_ as br,a as st,M as to,b as Mo,d as fo,g as Bt}from"./useDebounce-KloUpVAw.js";import{a as yr,L as jt,b as Cr,V as Eo,c as Ao}from"./VisibilityIcon-nq_zBLTG.js";import{S as wr,a as jr,b as Ir,c as kr,F as Sr,I as Kt,u as ho}from"./useLoading-1GM5JUMl.js";import{d as oo,M as Nr,s as q,K as Rr,n as it,j as $o,p as Y,F as It,V as zo,q as lt,D as Fo,c as _o,I as Lr,S as Dr,N as go,O as Tr,v as Pr,A as Or,Q as Ue,x as Mr,P as Er,L as Bo,B as Ce}from"./Button-Y8r740D0.js";import{_ as Ar}from"./useLocalStorage-fn64V-Iu.js";import{a as ot}from"./Typography-Ugz7CGU8.js";import{S as Vo,O as Jt}from"./Select-Gl6RUiyX.js";import{c as ro}from"./createSvgIcon-LnoQSaos.js";import{u as Vt}from"./useControlled-c04xw6hS.js";import{C as $r}from"./Checkbox-4xG-yJfH.js";import{L as zr}from"./Link-B2ydOwab.js";import{R as Fr,s as _r}from"./ResourceIcon-rz_9chuf.js";import{D as Gt}from"./Divider-PmcpRuGM.js";const Br=o=>{const e=p.useRef({});return p.useEffect(()=>{e.current=o}),e.current};function xo(o){return typeof o.normalize<"u"?o.normalize("NFD").replace(/[\u0300-\u036f]/g,""):o}function Vr(o={}){const{ignoreAccents:e=!0,ignoreCase:n=!0,limit:s,matchFrom:i="any",stringify:a,trim:u=!1}=o;return(d,{inputValue:r,getOptionLabel:g})=>{let m=u?r.trim():r;n&&(m=m.toLowerCase()),e&&(m=xo(m));const y=m?d.filter(x=>{let C=(a||g)(x);return n&&(C=C.toLowerCase()),e&&(C=xo(C)),i==="start"?C.indexOf(m)===0:C.indexOf(m)>-1}):d;return typeof s=="number"?y.slice(0,s):y}}function Ut(o,e){for(let n=0;n<o.length;n+=1)if(e(o[n]))return n;return-1}const Ur=Vr(),vo=5,Hr=o=>{var e;return o.current!==null&&((e=o.current.parentElement)==null?void 0:e.contains(document.activeElement))};function Wr(o){const{unstable_isActiveElementInListbox:e=Hr,unstable_classNamePrefix:n="Mui",autoComplete:s=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:u=!1,clearOnBlur:d=!o.freeSolo,clearOnEscape:r=!1,componentName:g="useAutocomplete",defaultValue:m=o.multiple?[]:null,disableClearable:y=!1,disableCloseOnSelect:x=!1,disabled:C,disabledItemsFocusable:k=!1,disableListWrap:I=!1,filterOptions:E=Ur,filterSelectedOptions:B=!1,freeSolo:h=!1,getOptionDisabled:f,getOptionKey:R,getOptionLabel:H=c=>{var l;return(l=c.label)!=null?l:c},groupBy:w,handleHomeEndKeys:j=!o.freeSolo,id:S,includeInputInList:z=!1,inputValue:W,isOptionEqualToValue:te=(c,l)=>c===l,multiple:$=!1,onChange:pe,onClose:ve,onHighlightChange:ge,onInputChange:J,onOpen:Ne,open:Re,openOnFocus:Le=!1,options:je,readOnly:be=!1,selectOnFocus:Ye=!o.freeSolo,value:v}=o,T=oo(S);let O=H;O=c=>{const l=H(c);return typeof l!="string"?String(l):l};const ne=p.useRef(!1),Q=p.useRef(!0),V=p.useRef(null),re=p.useRef(null),[ae,St]=p.useState(null),[ce,Qe]=p.useState(-1),ct=i?0:-1,F=p.useRef(ct),[D,De]=Vt({controlled:v,default:m,name:g}),[A,me]=Vt({controlled:W,default:"",name:g,state:"inputValue"}),[Ae,Ze]=p.useState(!1),Fe=p.useCallback((c,l)=>{if(!($?D.length<l.length:l!==null)&&!d)return;let L;if($)L="";else if(l==null)L="";else{const _=O(l);L=typeof _=="string"?_:""}A!==L&&(me(L),J&&J(c,L,"reset"))},[O,A,$,J,me,d,D]),[Te,dt]=Vt({controlled:Re,default:!1,name:g,state:"open"}),[Nt,ut]=p.useState(!0),$e=!$&&D!=null&&A===O(D),ie=Te&&!be,U=ie?E(je.filter(c=>!(B&&($?D:[D]).some(l=>l!==null&&te(c,l)))),{inputValue:$e&&Nt?"":A,getOptionLabel:O}):[],de=Br({filteredOptions:U,value:D,inputValue:A});p.useEffect(()=>{const c=D!==de.value;Ae&&!c||h&&!c||Fe(null,D)},[D,Fe,Ae,de.value,h]);const et=Te&&U.length>0&&!be,Ie=Ct(c=>{c===-1?V.current.focus():ae.querySelector(`[data-tag-index="${c}"]`).focus()});p.useEffect(()=>{$&&ce>D.length-1&&(Qe(-1),Ie(-1))},[D,$,ce,Ie]);function Rt(c,l){if(!re.current||c<0||c>=U.length)return-1;let b=c;for(;;){const L=re.current.querySelector(`[data-option-index="${b}"]`),_=k?!1:!L||L.disabled||L.getAttribute("aria-disabled")==="true";if(L&&L.hasAttribute("tabindex")&&!_)return b;if(l==="next"?b=(b+1)%U.length:b=(b-1+U.length)%U.length,b===c)return-1}}const ke=Ct(({event:c,index:l,reason:b="auto"})=>{if(F.current=l,l===-1?V.current.removeAttribute("aria-activedescendant"):V.current.setAttribute("aria-activedescendant",`${T}-option-${l}`),ge&&ge(c,l===-1?null:U[l],b),!re.current)return;const L=re.current.querySelector(`[role="option"].${n}-focused`);L&&(L.classList.remove(`${n}-focused`),L.classList.remove(`${n}-focusVisible`));let _=re.current;if(re.current.getAttribute("role")!=="listbox"&&(_=re.current.parentElement.querySelector('[role="listbox"]')),!_)return;if(l===-1){_.scrollTop=0;return}const K=re.current.querySelector(`[data-option-index="${l}"]`);if(K&&(K.classList.add(`${n}-focused`),b==="keyboard"&&K.classList.add(`${n}-focusVisible`),_.scrollHeight>_.clientHeight&&b!=="mouse"&&b!=="touch")){const X=K,fe=_.clientHeight+_.scrollTop,bt=X.offsetTop+X.offsetHeight;bt>fe?_.scrollTop=bt-_.clientHeight:X.offsetTop-X.offsetHeight*(w?1.3:0)<_.scrollTop&&(_.scrollTop=X.offsetTop-X.offsetHeight*(w?1.3:0))}}),le=Ct(({event:c,diff:l,direction:b="next",reason:L="auto"})=>{if(!ie)return;const K=Rt((()=>{const X=U.length-1;if(l==="reset")return ct;if(l==="start")return 0;if(l==="end")return X;const fe=F.current+l;return fe<0?fe===-1&&z?-1:I&&F.current!==-1||Math.abs(l)>1?0:X:fe>X?fe===X+1&&z?-1:I||Math.abs(l)>1?X:0:fe})(),b);if(ke({index:K,reason:L,event:c}),s&&l!=="reset")if(K===-1)V.current.value=A;else{const X=O(U[K]);V.current.value=X,X.toLowerCase().indexOf(A.toLowerCase())===0&&A.length>0&&V.current.setSelectionRange(A.length,X.length)}}),pt=()=>{const c=(l,b)=>{const L=l?O(l):"",_=b?O(b):"";return L===_};if(F.current!==-1&&de.filteredOptions&&de.filteredOptions.length!==U.length&&de.inputValue===A&&($?D.length===de.value.length&&de.value.every((l,b)=>O(D[b])===O(l)):c(de.value,D))){const l=de.filteredOptions[F.current];if(l&&U.some(L=>O(L)===O(l)))return!0}return!1},_e=p.useCallback(()=>{if(!ie||pt())return;const c=$?D[0]:D;if(U.length===0||c==null){le({diff:"reset"});return}if(re.current){if(c!=null){const l=U[F.current];if($&&l&&Ut(D,L=>te(l,L))!==-1)return;const b=Ut(U,L=>te(L,c));b===-1?le({diff:"reset"}):ke({index:b});return}if(F.current>=U.length-1){ke({index:U.length-1});return}ke({index:F.current})}},[U.length,$?!1:D,B,le,ke,ie,A,$]),mt=Ct(c=>{Nr(re,c),c&&_e()});p.useEffect(()=>{_e()},[_e]);const ye=c=>{Te||(dt(!0),ut(!0),Ne&&Ne(c))},G=(c,l)=>{Te&&(dt(!1),ve&&ve(c,l))},Z=(c,l,b,L)=>{if($){if(D.length===l.length&&D.every((_,K)=>_===l[K]))return}else if(D===l)return;pe&&pe(c,l,b,L),De(l)},ee=p.useRef(!1),se=(c,l,b="selectOption",L="options")=>{let _=b,K=l;if($){K=Array.isArray(D)?D.slice():[];const X=Ut(K,fe=>te(l,fe));X===-1?K.push(l):L!=="freeSolo"&&(K.splice(X,1),_="removeOption")}Fe(c,K),Z(c,K,_,{option:l}),!x&&(!c||!c.ctrlKey&&!c.metaKey)&&G(c,_),(u===!0||u==="touch"&&ee.current||u==="mouse"&&!ee.current)&&V.current.blur()};function Lt(c,l){if(c===-1)return-1;let b=c;for(;;){if(l==="next"&&b===D.length||l==="previous"&&b===-1)return-1;const L=ae.querySelector(`[data-tag-index="${b}"]`);if(!L||!L.hasAttribute("tabindex")||L.disabled||L.getAttribute("aria-disabled")==="true")b+=l==="next"?1:-1;else return b}}const ft=(c,l)=>{if(!$)return;A===""&&G(c,"toggleInput");let b=ce;ce===-1?A===""&&l==="previous"&&(b=D.length-1):(b+=l==="next"?1:-1,b<0&&(b=0),b===D.length&&(b=-1)),b=Lt(b,l),Qe(b),Ie(b)},ht=c=>{ne.current=!0,me(""),J&&J(c,"","clear"),Z(c,$?[]:null,"clear")},Dt=c=>l=>{if(c.onKeyDown&&c.onKeyDown(l),!l.defaultMuiPrevented&&(ce!==-1&&["ArrowLeft","ArrowRight"].indexOf(l.key)===-1&&(Qe(-1),Ie(-1)),l.which!==229))switch(l.key){case"Home":ie&&j&&(l.preventDefault(),le({diff:"start",direction:"next",reason:"keyboard",event:l}));break;case"End":ie&&j&&(l.preventDefault(),le({diff:"end",direction:"previous",reason:"keyboard",event:l}));break;case"PageUp":l.preventDefault(),le({diff:-vo,direction:"previous",reason:"keyboard",event:l}),ye(l);break;case"PageDown":l.preventDefault(),le({diff:vo,direction:"next",reason:"keyboard",event:l}),ye(l);break;case"ArrowDown":l.preventDefault(),le({diff:1,direction:"next",reason:"keyboard",event:l}),ye(l);break;case"ArrowUp":l.preventDefault(),le({diff:-1,direction:"previous",reason:"keyboard",event:l}),ye(l);break;case"ArrowLeft":ft(l,"previous");break;case"ArrowRight":ft(l,"next");break;case"Enter":if(F.current!==-1&&ie){const b=U[F.current],L=f?f(b):!1;if(l.preventDefault(),L)return;se(l,b,"selectOption"),s&&V.current.setSelectionRange(V.current.value.length,V.current.value.length)}else h&&A!==""&&$e===!1&&($&&l.preventDefault(),se(l,A,"createOption","freeSolo"));break;case"Escape":ie?(l.preventDefault(),l.stopPropagation(),G(l,"escape")):r&&(A!==""||$&&D.length>0)&&(l.preventDefault(),l.stopPropagation(),ht(l));break;case"Backspace":if($&&!be&&A===""&&D.length>0){const b=ce===-1?D.length-1:ce,L=D.slice();L.splice(b,1),Z(l,L,"removeOption",{option:D[b]})}break;case"Delete":if($&&!be&&A===""&&D.length>0&&ce!==-1){const b=ce,L=D.slice();L.splice(b,1),Z(l,L,"removeOption",{option:D[b]})}break}},Tt=c=>{Ze(!0),Le&&!ne.current&&ye(c)},gt=c=>{if(e(re)){V.current.focus();return}Ze(!1),Q.current=!0,ne.current=!1,a&&F.current!==-1&&ie?se(c,U[F.current],"blur"):a&&h&&A!==""?se(c,A,"blur","freeSolo"):d&&Fe(c,D),G(c,"blur")},Pt=c=>{const l=c.target.value;A!==l&&(me(l),ut(!1),J&&J(c,l,"input")),l===""?!y&&!$&&Z(c,null,"clear"):ye(c)},Ot=c=>{const l=Number(c.currentTarget.getAttribute("data-option-index"));F.current!==l&&ke({event:c,index:l,reason:"mouse"})},Mt=c=>{ke({event:c,index:Number(c.currentTarget.getAttribute("data-option-index")),reason:"touch"}),ee.current=!0},Et=c=>{const l=Number(c.currentTarget.getAttribute("data-option-index"));se(c,U[l],"selectOption"),ee.current=!1},At=c=>l=>{const b=D.slice();b.splice(c,1),Z(l,b,"removeOption",{option:D[c]})},xt=c=>{Te?G(c,"toggleInput"):ye(c)},$t=c=>{c.currentTarget.contains(c.target)&&c.target.getAttribute("id")!==T&&c.preventDefault()},zt=c=>{c.currentTarget.contains(c.target)&&(V.current.focus(),Ye&&Q.current&&V.current.selectionEnd-V.current.selectionStart===0&&V.current.select(),Q.current=!1)},Ft=c=>{!C&&(A===""||!Te)&&xt(c)};let tt=h&&A.length>0;tt=tt||($?D.length>0:D!==null);let vt=U;return w&&(vt=U.reduce((c,l,b)=>{const L=w(l);return c.length>0&&c[c.length-1].group===L?c[c.length-1].options.push(l):c.push({key:b,index:b,group:L,options:[l]}),c},[])),C&&Ae&&gt(),{getRootProps:(c={})=>N({"aria-owns":et?`${T}-listbox`:null},c,{onKeyDown:Dt(c),onMouseDown:$t,onClick:zt}),getInputLabelProps:()=>({id:`${T}-label`,htmlFor:T}),getInputProps:()=>({id:T,value:A,onBlur:gt,onFocus:Tt,onChange:Pt,onMouseDown:Ft,"aria-activedescendant":ie?"":null,"aria-autocomplete":s?"both":"list","aria-controls":et?`${T}-listbox`:void 0,"aria-expanded":et,autoComplete:"off",ref:V,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:C}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:ht}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:xt}),getTagProps:({index:c})=>N({key:c,"data-tag-index":c,tabIndex:-1},!be&&{onDelete:At(c)}),getListboxProps:()=>({role:"listbox",id:`${T}-listbox`,"aria-labelledby":`${T}-label`,ref:mt,onMouseDown:c=>{c.preventDefault()}}),getOptionProps:({index:c,option:l})=>{var b;const L=($?D:[D]).some(K=>K!=null&&te(l,K)),_=f?f(l):!1;return{key:(b=R==null?void 0:R(l))!=null?b:O(l),tabIndex:-1,role:"option",id:`${T}-option-${c}`,onMouseMove:Ot,onClick:Et,onTouchStart:Mt,"data-option-index":c,"aria-disabled":_,"aria-selected":L}},id:T,inputValue:A,value:D,dirty:tt,expanded:ie&&ae,popupOpen:ie,focused:Ae||ce!==-1,anchorEl:ae,setAnchorEl:St,focusedTag:ce,groupedOptions:vt}}const qr=ro(t.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Kr=ro(t.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown");function Jr(o){return at("MuiChip",o)}const Gr=nt("MuiChip",["root","clickable","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","disabled","endDecorator","focusVisible","label","labelSm","labelMd","labelLg","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantSolid","variantSoft","variantOutlined"]),Xt=Gr,Xr=p.createContext({disabled:void 0,variant:void 0,color:void 0}),Uo=Xr,Yr=["children","className","color","onClick","disabled","size","variant","startDecorator","endDecorator","component","slots","slotProps"],Qr=o=>{const{disabled:e,size:n,color:s,clickable:i,variant:a,focusVisible:u}=o,d={root:["root",e&&"disabled",s&&`color${ue(s)}`,n&&`size${ue(n)}`,a&&`variant${ue(a)}`,i&&"clickable"],action:["action",e&&"disabled",u&&"focusVisible"],label:["label",n&&`label${ue(n)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return lt(d,Jr,{})},Zr=q("div",{name:"JoyChip",slot:"Root",overridesResolver:(o,e)=>e.root})(({theme:o,ownerState:e})=>{var n,s,i;const a=(n=o.variants[e.variant])==null?void 0:n[e.color],{borderRadius:u}=Rr({theme:o,ownerState:e},["borderRadius"]);return[N({"--Chip-decoratorChildOffset":"min(calc(var(--Chip-paddingInline) - (var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2), var(--Chip-paddingInline))","--Chip-decoratorChildRadius":"max(var(--_Chip-radius) - var(--variant-borderWidth, 0px) - var(--_Chip-paddingBlock), min(var(--_Chip-paddingBlock) + var(--variant-borderWidth, 0px), var(--_Chip-radius) / 2))","--Chip-deleteRadius":"var(--Chip-decoratorChildRadius)","--Chip-deleteSize":"var(--Chip-decoratorChildHeight)","--Avatar-radius":"var(--Chip-decoratorChildRadius)","--Avatar-size":"var(--Chip-decoratorChildHeight)","--Icon-margin":"initial","--Icon-color":"currentColor","--unstable_actionRadius":"var(--_Chip-radius)"},e.size==="sm"&&{"--Chip-paddingInline":"0.375rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 2 * var(--variant-borderWidth))","--Icon-fontSize":o.vars.fontSize.sm,"--_Chip-minHeight":"var(--Chip-minHeight, 1.25rem)",gap:"3px"},e.size==="md"&&{"--Chip-paddingInline":"0.5rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.25rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":o.vars.fontSize.md,"--_Chip-minHeight":"var(--Chip-minHeight, 1.5rem)",gap:"0.25rem"},e.size==="lg"&&{"--Chip-paddingInline":"0.75rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.375rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":o.vars.fontSize.lg,"--_Chip-minHeight":"var(--Chip-minHeight, 1.75rem)",gap:"0.375rem"},{"--_Chip-radius":"var(--Chip-radius, 1.5rem)","--_Chip-paddingBlock":"max((var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2, 0px)",minHeight:"var(--_Chip-minHeight)",maxWidth:"max-content",paddingInline:"var(--Chip-paddingInline)",borderRadius:"var(--_Chip-radius)",position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",textDecoration:"none",verticalAlign:"middle",boxSizing:"border-box"},o.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],{fontWeight:o.vars.fontWeight.md,[`&.${Xt.disabled}`]:{color:(s=o.variants[`${e.variant}Disabled`])==null||(s=s[e.color])==null?void 0:s.color}}),...e.clickable?[{"--variant-borderWidth":"0px",color:a==null?void 0:a.color}]:[N({backgroundColor:o.vars.palette.background.surface},a,{[`&.${Xt.disabled}`]:(i=o.variants[`${e.variant}Disabled`])==null?void 0:i[e.color]})],u!==void 0&&{"--_Chip-radius":u}]}),es=q("span",{name:"JoyChip",slot:"Label",overridesResolver:(o,e)=>e.label})(({ownerState:o})=>N({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",order:1,minInlineSize:0,flexGrow:1},o.clickable&&{zIndex:1,pointerEvents:"none"})),ts=q("button",{name:"JoyChip",slot:"Action",overridesResolver:(o,e)=>e.action})(({theme:o,ownerState:e})=>{var n,s,i,a;return[{"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":o.vars.palette.text.icon,position:"absolute",zIndex:0,top:0,left:0,bottom:0,right:0,width:"100%",border:"none",cursor:"pointer",padding:"initial",margin:"initial",backgroundColor:"initial",textDecoration:"none",borderRadius:"inherit",[o.focus.selector]:o.focus.default},N({backgroundColor:o.vars.palette.background.surface},(n=o.variants[e.variant])==null?void 0:n[e.color]),{"&:hover":{"@media (hover: hover)":(s=o.variants[`${e.variant}Hover`])==null?void 0:s[e.color]}},{"&:active":(i=o.variants[`${e.variant}Active`])==null?void 0:i[e.color]},{[`&.${Xt.disabled}`]:(a=o.variants[`${e.variant}Disabled`])==null?void 0:a[e.color]}]}),os=q("span",{name:"JoyChip",slot:"StartDecorator",overridesResolver:(o,e)=>e.startDecorator})({"--Avatar-marginInlineStart":"calc(var(--Chip-decoratorChildOffset) * -1)","--IconButton-margin":"0 calc(-1 * var(--Chip-paddingInline) / 3) 0 calc(var(--Chip-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Chip-paddingInline) / -4)",display:"inherit",order:0,zIndex:1,pointerEvents:"none"}),rs=q("span",{name:"JoyChip",slot:"EndDecorator",overridesResolver:(o,e)=>e.endDecorator})({"--IconButton-margin":"0 calc(var(--Chip-decoratorChildOffset) * -1) 0 calc(-1 * var(--Chip-paddingInline) / 3)","--Icon-margin":"0 calc(var(--Chip-paddingInline) / -4) 0 0",display:"inherit",order:2,zIndex:1,pointerEvents:"none"}),ss=p.forwardRef(function(e,n){const s=it({props:e,name:"JoyChip"}),{children:i,className:a,color:u="neutral",onClick:d,disabled:r=!1,size:g="md",variant:m="soft",startDecorator:y,endDecorator:x,component:C,slots:k={},slotProps:I={}}=s,E=Ee(s,Yr),B=!!d||!!I.action,h=N({},s,{disabled:r,size:g,color:u,variant:m,clickable:B,focusVisible:!1}),f=typeof I.action=="function"?I.action(h):I.action,R=p.useRef(null),{focusVisible:H,getRootProps:w}=$o(N({},f,{disabled:r,rootRef:R}));h.focusVisible=H;const j=Qr(h),S=N({},E,{component:C,slots:k,slotProps:I}),[z,W]=Y("root",{ref:n,className:It(j.root,a),elementType:Zr,externalForwardedProps:S,ownerState:h}),[te,$]=Y("label",{className:j.label,elementType:es,externalForwardedProps:S,ownerState:h}),pe=oo($.id),[ve,ge]=Y("action",{className:j.action,elementType:ts,externalForwardedProps:S,ownerState:h,getSlotProps:w,additionalProps:{"aria-labelledby":pe,as:f==null?void 0:f.component,onClick:d}}),[J,Ne]=Y("startDecorator",{className:j.startDecorator,elementType:os,externalForwardedProps:S,ownerState:h}),[Re,Le]=Y("endDecorator",{className:j.endDecorator,elementType:rs,externalForwardedProps:S,ownerState:h}),je=p.useMemo(()=>({disabled:r}),[r]);return t.jsx(Uo.Provider,{value:je,children:t.jsx(zo,{variant:m,color:u,children:t.jsxs(z,N({},W,{children:[B&&t.jsx(ve,N({},ge)),t.jsx(te,N({},$,{id:pe,children:i})),y&&t.jsx(J,N({},Ne,{children:y})),x&&t.jsx(Re,N({},Le,{children:x}))]}))})})}),Ho=ss,ns=ro(t.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Cancel");function as(o){return at("MuiChipDelete",o)}nt("MuiChipDelete",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSolid","variantSoft","variantOutlined"]);var bo;const is=["children","variant","color","disabled","onKeyDown","onDelete","onClick","component","slots","slotProps"],ls=["onDelete"],cs=o=>{const{focusVisible:e,variant:n,color:s,disabled:i}=o,a={root:["root",i&&"disabled",e&&"focusVisible",n&&`variant${ue(n)}`,s&&`color${ue(s)}`]};return lt(a,as,{})},ds=q(eo,{name:"JoyChipDelete",slot:"Root",overridesResolver:(o,e)=>e.root})(({theme:o})=>({"--IconButton-size":"var(--Chip-deleteSize, 2rem)","--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.3)",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:o.vars.fontSize.sm,paddingInline:"2px",pointerEvents:"visible",borderRadius:"var(--Chip-deleteRadius, 50%)",zIndex:1,padding:0})),us=p.forwardRef(function(e,n){const s=it({props:e,name:"JoyChipDelete"}),{children:i,variant:a="plain",color:u="neutral",disabled:d,onKeyDown:r,onDelete:g,onClick:m,component:y,slots:x={},slotProps:C={}}=s,k=Ee(s,is),I=p.useContext(Uo),{variant:E=a,color:B=u}=Fo(e.variant,e.color,!0),h=e.color||B,f=d??I.disabled,R=p.useRef(null),H=_o(R,n),{focusVisible:w,getRootProps:j}=$o(N({},s,{disabled:f,rootRef:H})),S=N({},s,{disabled:f,variant:E,color:h,focusVisible:w}),z=cs(S),W=N({},k,{component:y,slots:x,slotProps:C}),te=J=>{!f&&g&&g(J),m&&m(J)},$=J=>{["Backspace","Enter","Delete"].includes(J.key)&&(J.preventDefault(),!f&&g&&g(J)),r&&r(J)},[pe,ve]=Y("root",{ref:n,elementType:ds,getSlotProps:j,externalForwardedProps:W,ownerState:S,additionalProps:{as:y,onKeyDown:$,onClick:te},className:z.root}),ge=Ee(ve,ls);return t.jsx(pe,N({},ge,{children:i??(bo||(bo=t.jsx(ns,{})))}))}),ps=us;function ms(o){return at("MuiListSubheader",o)}nt("MuiListSubheader",["root","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const fs=["component","className","children","id","sticky","variant","color","slots","slotProps"],hs=o=>{const{variant:e,color:n,sticky:s}=o,i={root:["root",s&&"sticky",n&&`color${ue(n)}`,e&&`variant${ue(e)}`]};return lt(i,ms,{})},gs=q("div",{name:"JoyListSubheader",slot:"Root",overridesResolver:(o,e)=>e.root})(({theme:o,ownerState:e})=>{var n,s;return N({boxSizing:"border-box",display:"flex",alignItems:"center",marginInline:"var(--ListItem-marginInline)",paddingBlock:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)",minBlockSize:"var(--ListItem-minHeight)"},o.typography["body-xs"],{fontSize:"max(0.75em, 0.625rem)",textTransform:"uppercase",letterSpacing:"0.1em"},e.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:"var(--ListItem-stickyBackground)"},{color:e.color?`var(--_Link-color, rgba(${(n=o.vars.palette[e.color])==null?void 0:n.mainChannel} / 1))`:o.vars.palette.text.tertiary},e.instanceColor&&{[`&:not([${Lr}])`]:{"--_Link-color":o.vars.palette.text.secondary}},(s=o.variants[e.variant])==null?void 0:s[e.color])}),xs=p.forwardRef(function(e,n){const s=it({props:e,name:"JoyListSubheader"}),{component:i,className:a,children:u,id:d,sticky:r=!1,variant:g,color:m,slots:y={},slotProps:x={}}=s,C=Ee(s,fs),k=oo(d),I=p.useContext(yr);p.useEffect(()=>{I&&I(k||"")},[I,k]);const E=N({instanceColor:e.color},s,{id:k,sticky:r,variant:g,color:g?m??"neutral":m}),B=hs(E),h=N({},C,{component:i,slots:y,slotProps:x}),[f,R]=Y("root",{ref:n,className:It(B.root,a),elementType:gs,externalForwardedProps:h,ownerState:E,additionalProps:{as:i,id:k}});return t.jsx(f,N({},R,{children:u}))}),vs=xs;function bs(o){return at("MuiAutocomplete",o)}const ys=nt("MuiAutocomplete",["root","wrapper","input","startDecorator","endDecorator","formControl","focused","disabled","error","multiple","limitTag","hasPopupIcon","hasClearIcon","clearIndicator","popupIndicator","popupIndicatorOpen","listbox","option","loading","noOptions","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]),Me=ys,Wo=q(Dr)(({theme:o,ownerState:e})=>{var n;const s=(n=o.variants[e.variant])==null?void 0:n[e.color];return N({"--focus-outline-offset":`calc(${o.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":(s==null?void 0:s.backgroundColor)||(s==null?void 0:s.background)||o.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},Pr,{boxShadow:o.shadow.md,borderRadius:`var(--List-radius, ${o.vars.radius.sm})`},!(s!=null&&s.backgroundColor)&&{backgroundColor:o.vars.palette.background.popup},{zIndex:o.vars.zIndex.popup,overflow:"auto",maxHeight:"40vh",position:"relative","&:empty":{visibility:"hidden"},[`& .${go.nested}, & .${go.nested} .${Tr.root}`]:{position:"initial"}})});q(Wo,{name:"JoyAutocompleteListbox",slot:"Root",overridesResolver:(o,e)=>e.root})({});function Cs(o){return at("MuiAutocompleteOption",o)}nt("MuiAutocompleteOption",["root","focused","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const ws=["children","component","color","variant","className","slots","slotProps"],js=o=>{const{color:e,variant:n}=o,s={root:["root",e&&`color${ue(e)}`,n&&`variant${ue(n)}`]};return lt(s,Cs,{})},qo=q(Or)(({theme:o,ownerState:e})=>{var n,s;return{'&[aria-disabled="true"]':(n=o.variants[`${e.variant}Disabled`])==null?void 0:n[e.color],'&[aria-selected="true"]':N({},(s=o.variants[`${e.variant}Active`])==null?void 0:s[e.color],{fontWeight:o.vars.fontWeight.md})}}),Is=q(qo,{name:"JoyAutocompleteOption",slot:"Root",overridesResolver:(o,e)=>e.root})({}),ks=p.forwardRef(function(e,n){const s=it({props:e,name:"JoyAutocompleteOption"}),{children:i,component:a="li",color:u="neutral",variant:d="plain",className:r,slots:g={},slotProps:m={}}=s,y=Ee(s,ws),{variant:x=d,color:C=u}=Fo(e.variant,e.color),k=N({},s,{component:a,color:C,variant:x}),I=js(k),E=N({},y,{component:a,slots:g,slotProps:m}),[B,h]=Y("root",{ref:n,className:It(I.root,r),elementType:Is,externalForwardedProps:E,ownerState:k,additionalProps:{as:a,role:"option"}});return t.jsx(B,N({},h,{children:i}))}),Ss=ks;var yo,Co;const Ns=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoHighlight","autoSelect","autoFocus","blurOnSelect","clearIcon","clearOnBlur","clearOnEscape","clearText","closeText","defaultValue","disableCloseOnSelect","disabledItemsFocusable","disableListWrap","disableClearable","disabled","endDecorator","error","filterOptions","filterSelectedOptions","forcePopupIcon","freeSolo","getLimitTagsText","getOptionDisabled","getOptionKey","getOptionLabel","handleHomeEndKeys","includeInputInList","isOptionEqualToValue","groupBy","id","inputValue","limitTags","loading","loadingText","multiple","name","noOptionsText","onChange","onClose","onHighlightChange","onInputChange","onOpen","open","openOnFocus","openText","options","placeholder","popupIcon","readOnly","renderGroup","renderOption","renderTags","required","type","startDecorator","size","color","variant","value","component","selectOnFocus","slots","slotProps"],Rs=["onDelete"],Ls=["onBlur","onFocus","onMouseDown"],Ds=o=>o.current!==null&&o.current.contains(document.activeElement),Ts=o=>{var e;return(e=o.label)!=null?e:o},Ps=o=>`+${o}`,Os=o=>t.jsxs(jt,{nested:!0,children:[t.jsx(vs,{sticky:!0,children:o.group}),t.jsx(Bo,{children:o.children})]},o.key),Ms=o=>{const{disabled:e,focused:n,hasClearIcon:s,hasPopupIcon:i,popupOpen:a,variant:u,color:d,size:r,multiple:g}=o,m={root:["root",n&&"focused",s&&"hasClearIcon",i&&"hasPopupIcon",u&&`variant${ue(u)}`,d&&`color${ue(d)}`,r&&`size${ue(r)}`],wrapper:["wrapper",g&&"multiple"],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",a&&"popupIndicatorOpen",e&&"disabled"],listbox:["listbox"],option:["option"],loading:["loading"],noOptions:["noOptions"],limitTag:["limitTag"]};return lt(m,bs,{})},Es=q(wr,{name:"JoyAutocomplete",slot:"Root",overridesResolver:(o,e)=>e.root})(({ownerState:o})=>N({},o.size==="sm"&&{"--Autocomplete-wrapperGap":"3px"},o.size==="md"&&{"--Autocomplete-wrapperGap":"3px"},o.size==="lg"&&{"--Autocomplete-wrapperGap":"4px"},{"@media (pointer: fine)":{[`&:hover .${Me.clearIndicator}`]:{visibility:"visible"}}},o.multiple&&!o.startDecorator&&{paddingInlineStart:0})),As=q("div",{name:"JoyAutocomplete",slot:"Wrapper",overridesResolver:(o,e)=>e.wrapper})(({ownerState:o})=>({flex:1,minWidth:0,display:"flex",alignItems:"center",flexWrap:"wrap",gap:"var(--Autocomplete-wrapperGap)",[`&.${Me.multiple}`]:N({paddingBlock:"var(--Autocomplete-wrapperGap)"},!o.startDecorator&&{paddingInlineStart:"var(--Autocomplete-wrapperGap)"},!o.endDecorator&&{paddingInlineEnd:"var(--Autocomplete-wrapperGap)"})})),$s=q(jr,{name:"JoyAutocomplete",slot:"Input",overridesResolver:(o,e)=>e.input})(({ownerState:o})=>N({minWidth:30,minHeight:"var(--Chip-minHeight)"},o.multiple&&{marginInlineStart:"calc(var(--Autocomplete-wrapperGap) * 2.5)"})),zs=q(Ir,{name:"JoyAutocomplete",slot:"StartDecorator",overridesResolver:(o,e)=>e.startDecorator})({}),Fs=q(kr,{name:"JoyAutocomplete",slot:"EndDecorator",overridesResolver:(o,e)=>e.endDecorator})(({ownerState:o})=>N({},(o.hasClearIcon||o.hasPopupIcon)&&{"--Button-margin":"0px","--IconButton-margin":"0px","--Icon-margin":"0px"})),_s=q(eo,{name:"JoyAutocomplete",slot:"ClearIndicator",overridesResolver:(o,e)=>e.clearIndicator})(({ownerState:o})=>N({alignSelf:"center"},!o.hasPopupIcon&&{marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)"},{marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",visibility:o.focused?"visible":"hidden"})),Bs=q(eo,{name:"JoyAutocomplete",slot:"PopupIndicator",overridesResolver:(o,e)=>e.popupIndicator})({alignSelf:"center",marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)",[`&.${Me.popupIndicatorOpen}`]:{transform:"rotate(180deg)","--Icon-color":"currentColor"}}),Vs=q(Wo,{name:"JoyAutocomplete",slot:"Listbox",overridesResolver:(o,e)=>e.listbox})(({theme:o})=>({zIndex:`var(--unstable_popup-zIndex, ${o.vars.zIndex.popup})`})),Us=q(qo,{name:"JoyAutocomplete",slot:"Option",overridesResolver:(o,e)=>e.option})({}),Hs=q(jt,{name:"JoyAutocomplete",slot:"Loading",overridesResolver:(o,e)=>e.loading})(({theme:o})=>({color:(o.vars||o).palette.text.secondary})),Ws=q(jt,{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(o,e)=>e.noOptions})(({theme:o})=>({color:(o.vars||o).palette.text.secondary})),qs=q("div",{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(o,e)=>e.noOptions})({marginInlineStart:"calc(var(--Input-paddingInline) / 2)",marginBlockStart:"var(--_Input-paddingBlock)"}),Ks=p.forwardRef(function(e,n){var s,i,a,u,d,r,g;const m=it({props:e,name:"JoyAutocomplete"}),{"aria-describedby":y,"aria-label":x,"aria-labelledby":C,autoFocus:k,clearIcon:I=yo||(yo=t.jsx(qr,{fontSize:"md"})),clearText:E="Clear",closeText:B="Close",disableClearable:h=!1,disabled:f,endDecorator:R,error:H=!1,forcePopupIcon:w="auto",freeSolo:j=!1,getLimitTagsText:S=Ps,getOptionLabel:z=Ts,groupBy:W,id:te,limitTags:$=-1,loading:pe=!1,loadingText:ve="Loading…",multiple:ge=!1,name:J,noOptionsText:Ne="No options",openText:Re="Open",placeholder:Le,popupIcon:je=Co||(Co=t.jsx(Kr,{})),readOnly:be=!1,renderGroup:Ye=Os,renderOption:v,renderTags:T,required:O,type:ne,startDecorator:Q,size:V="md",color:re="neutral",variant:ae="outlined",component:St,slots:ce={},slotProps:Qe={}}=m,ct=Ee(m,Ns),F=p.useContext(Sr),D=(s=(i=e.error)!=null?i:F==null?void 0:F.error)!=null?s:H,De=(a=(u=e.size)!=null?u:F==null?void 0:F.size)!=null?a:V,A=(d=e.color)!=null?d:D?"danger":(r=F==null?void 0:F.color)!=null?r:re,me=(g=f??(F==null?void 0:F.disabled))!=null?g:!1,{getRootProps:Ae,getInputProps:Ze,getPopupIndicatorProps:Fe,getClearProps:Te,getTagProps:dt,getListboxProps:Nt,getOptionProps:ut,value:$e,dirty:ie,popupOpen:U,focused:de,focusedTag:et,anchorEl:Ie,setAnchorEl:Rt,inputValue:ke,groupedOptions:le}=Wr(N({},m,{id:te??(F==null?void 0:F.htmlFor),componentName:"Autocomplete",unstable_classNamePrefix:"Mui",unstable_isActiveElementInListbox:Ds})),{onMouseDown:pt}=Ze(),{onClick:_e}=Ae(),mt=!h&&!me&&ie&&!be,ye=(!j||w===!0)&&w!==!1,G=N({instanceColor:e.color},m,{value:$e,disabled:me,focused:de,getOptionLabel:z,hasOptions:!!le.length,hasClearIcon:mt,hasPopupIcon:ye,inputFocused:et===-1,popupOpen:U,size:De,color:A,variant:ae}),Z=Ms(G),ee=N({},ct,{component:St,slots:ce,slotProps:Qe});let se;if(ge&&$e.length>0){const P=he=>{const oe=dt(he),{onDelete:Be}=oe,Ve=Ee(oe,Rs);return N({disabled:me,size:De,onClick:Be},Ve)};T?se=T($e,P,G):se=$e.map((he,oe)=>t.jsx(Ho,{size:De,variant:"soft",color:"neutral",endDecorator:t.jsx(ps,N({},P({index:oe}))),children:z(he)},oe))}const Lt=_o(n,Rt),ft={[Me.disabled]:me,[Me.error]:D,[Me.focused]:de,[Me.formControl]:!!F},[ht,Dt]=Y("root",{ref:Lt,className:[Z.root,ft],elementType:Es,externalForwardedProps:ee,ownerState:G,getSlotProps:Ae,additionalProps:{onClick:P=>{_e&&_e(P),P.currentTarget===P.target&&pt&&pt(P)}}}),[Tt,gt]=Y("wrapper",{className:Z.wrapper,elementType:As,externalForwardedProps:ee,ownerState:G}),Pt={[Me.disabled]:me},[Ot,Mt]=Y("input",{className:[Z.input,Pt],elementType:$s,getSlotProps:P=>{const he=Ze(),{onBlur:oe,onFocus:Be,onMouseDown:Ve}=he,nr=Ee(he,Ls);return N({},nr,{onBlur:Pe=>{var Oe;oe==null||oe(Pe),(Oe=P.onBlur)==null||Oe.call(P,Pe)},onFocus:Pe=>{var Oe;Be==null||Be(Pe),(Oe=P.onFocus)==null||Oe.call(P,Pe)},onMouseDown:Pe=>{var Oe;Ve==null||Ve(Pe),(Oe=P.onMouseDown)==null||Oe.call(P,Pe)}})},externalForwardedProps:ee,ownerState:G,additionalProps:{autoFocus:k,placeholder:Le,name:J,readOnly:be,disabled:me,required:O??(F==null?void 0:F.required),type:ne,"aria-invalid":D||void 0,"aria-label":x,"aria-labelledby":C,"aria-describedby":y??(F==null?void 0:F["aria-describedby"])}}),[Et,At]=Y("startDecorator",{className:Z.startDecorator,elementType:zs,externalForwardedProps:ee,ownerState:G}),[xt,$t]=Y("endDecorator",{className:Z.endDecorator,elementType:Fs,externalForwardedProps:ee,ownerState:G}),[zt,Ft]=Y("clearIndicator",{className:Z.clearIndicator,elementType:_s,getSlotProps:Te,externalForwardedProps:ee,ownerState:G,getSlotOwnerState:P=>({size:P.size||De,variant:P.variant||Ue(ae,A).variant||"plain",color:P.color||Ue(ae,A).color||"neutral",disableColorInversion:!!e.color}),additionalProps:{"aria-label":E,title:E}}),[tt,vt]=Y("popupIndicator",{className:Z.popupIndicator,elementType:Bs,getSlotProps:Fe,externalForwardedProps:ee,ownerState:G,getSlotOwnerState:P=>({size:P.size||De,variant:P.variant||Ue(ae,A).variant||"plain",color:P.color||Ue(ae,A).color||"neutral",disableColorInversion:!!e.color}),additionalProps:{disabled:me,"aria-label":U?B:Re,title:U?B:Re,type:"button"}}),[c,l]=Y("listbox",{className:Z.listbox,elementType:Vs,getSlotProps:Nt,externalForwardedProps:ee,ownerState:G,getSlotOwnerState:P=>({size:P.size||De,variant:P.variant||ae,color:P.color||A,disableColorInversion:!P.disablePortal}),additionalProps:{anchorEl:Ie,open:U,style:Ie?{width:Ie.clientWidth}:{}}}),[b,L]=Y("loading",{className:Z.loading,elementType:Hs,externalForwardedProps:ee,ownerState:G}),[_,K]=Y("noOptions",{className:Z.noOptions,elementType:Ws,externalForwardedProps:ee,ownerState:G,additionalProps:{role:"presentation",onMouseDown:P=>{P.preventDefault()}}}),[X,fe]=Y("limitTag",{className:Z.limitTag,elementType:qs,externalForwardedProps:ee,ownerState:G});if($>-1&&Array.isArray(se)){const P=se.length-$;!de&&P>0&&(se=se.splice(0,$),se.push(t.jsx(X,N({},fe,{children:S(P)}),se.length)))}const[bt,or]=Y("option",{className:Z.option,elementType:Us,externalForwardedProps:ee,ownerState:G,getSlotOwnerState:P=>({variant:P.variant||Ue(ae,A).variant||"plain",color:P.color||Ue(ae,A).color||"neutral",disableColorInversion:!l.disablePortal}),additionalProps:{as:"li"}}),rr=v||((P,he)=>t.jsx(bt,N({},P,{children:z(he)}))),so=(P,he)=>{const oe=ut({option:P,index:he});return rr(N({},or,oe),P,{selected:!!oe["aria-selected"],inputValue:ke,ownerState:G})},sr=p.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...l.modifiers||[]],[l.modifiers]);let no=null;if(Ie){var ao;no=t.jsx(zo,{variant:ae,color:A,children:t.jsx(Mr,{nested:!0,children:t.jsxs(c,N({},l,{className:It(l.className),modifiers:sr},!((ao=m.slots)!=null&&ao.listbox)&&{as:Er,slots:{root:l.as||"ul"}},{children:[le.map((P,he)=>{if(W){const oe=P;return Ye({key:String(oe.key),group:oe.group,children:oe.options.map((Be,Ve)=>so(Be,oe.index+Ve))})}return so(P,he)}),pe&&le.length===0?t.jsx(b,N({},L,{children:ve})):null,le.length===0&&!j&&!pe?t.jsx(_,N({},K,{children:Ne})):null]}))})})}return t.jsxs(p.Fragment,{children:[t.jsxs(ht,N({},Dt,{children:[Q&&t.jsx(Et,N({},At,{children:Q})),t.jsxs(Tt,N({},gt,{children:[se,t.jsx(Ot,N({},Mt))]})),R&&t.jsx(xt,N({},$t,{children:R})),mt?t.jsx(zt,N({},Ft,{children:I})):null,ye?t.jsx(tt,N({},vt,{children:je})):null]})),no]})}),Ko=Ks,kt=()=>{const o=So(d=>d.tag),e=Yt();return{state:o,getState:()=>Se.getState().tag,fetchTags:async()=>{const{tags:d}=await yt.listTags({user:e.name});Se.dispatch(ar(d.map(r=>r.name)))},upsertTag:async d=>{await yt.upsertTag({name:d}),Se.dispatch(io(d))},batchUpsertTag:async d=>{await yt.batchUpsertTag({requests:d.map(r=>({name:r}))});for(const r of d)Se.dispatch(io(r))},deleteTag:async d=>{await yt.deleteTag({tag:{name:d,creator:e.name}}),Se.dispatch(ir(d))}}},Jo=()=>{const o=So(i=>i.resource),e=ze(),s=Qt().state.systemStatus.maxUploadSizeMiB;return{state:o,getState:()=>Se.getState().resource,async createResource(i){const{resource:a}=await lo.createResource(i);if(!a)throw new Error("resource is null");const u=o.resources;return Se.dispatch(co([a,...u])),a},async createResourceWithBlob(i){const{name:a,size:u}=i;if(u>s*1024*1024)return Promise.reject(e("message.maximum-upload-size-is",{size:s}));const d=new FormData;d.append("file",i,a);const{data:r}=await lr(d),g=o.resources;return Se.dispatch(co([r,...g])),r},async updateResource(i){const{resource:a}=await lo.updateResource(i);if(!a)throw new Error("resource is null");return Se.dispatch(cr(a)),a}}},Js=o=>{const e=ze(),{destroy:n,memoId:s}=o,i=Ge(),[a,u]=p.useState(""),d=mo();p.useEffect(()=>{i.getOrFetchMemoById(s).then(y=>{if(y){const x=mo(y.createTime);u(x)}else xe.error(e("message.memo-not-found")),n()})},[]);const r=()=>{n()},g=y=>{const x=y.target.value;u(x)},m=async()=>{try{await i.updateMemo({id:s,createTime:new Date(a)},["created_ts"]),xe.success(e("message.memo-updated-datetime")),r()}catch(y){console.error(y),xe.error(y.response.data.message)}};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"dialog-header-container",children:[t.jsx("p",{className:"title-text",children:e("message.change-memo-created-time")}),t.jsx(we,{size:"sm",onClick:r,children:t.jsx(M.X,{className:"w-5 h-auto"})})]}),t.jsxs("div",{className:"flex flex-col justify-start items-start !w-72 max-w-full",children:[t.jsx(Kt,{className:"w-full",type:"datetime-local",value:a,slotProps:{input:{max:d}},onChange:g}),t.jsxs("div",{className:"flex flex-row justify-end items-center mt-4 w-full gap-x-2",children:[t.jsx(Ce,{color:"neutral",variant:"plain",onClick:r,children:e("common.cancel")}),t.jsx(Ce,{color:"primary",onClick:m,children:e("common.save")})]})]})]})};function Gs(o){Xe({className:"change-memo-created-ts-dialog",dialogName:"change-memo-created-ts-dialog"},Js,{memoId:o})}const Xn=/#([^\s#,]+)/,Xs=o=>{const e=window.parse(o),n=new Set,s=(i,a)=>{for(const u of i)if(u&&(a(u),u.paragraphNode||u.unorderedListNode||u.orderedListNode)){const d=(u.paragraphNode||u.unorderedListNode||u.orderedListNode).children;Array.isArray(d)&&s(d,a)}};return s(e,i=>{var a;(a=i.tagNode)!=null&&a.content&&n.add(i.tagNode.content)}),Array.from(n)},Ys=["image/*","text/*","audio/*","video/*","application/*"],Qs=o=>{const e=ze(),{destroy:n,onCancel:s,onConfirm:i}=o,a=Jo(),[u,d]=p.useState({selectedMode:"local-file",uploadingFlag:!1}),[r,g]=p.useState({filename:"",externalLink:"",type:""}),[m,y]=p.useState([]),x=p.useRef(null),C=(w,j)=>{const S=m.findIndex(W=>W.name===w);if(S===-1)return;const z=[...m];if(j==="up"){if(S===0)return;const W=z[S-1];z[S-1]=z[S],z[S]=W}else if(j==="down"){if(S===m.length-1)return;const W=z[S+1];z[S+1]=z[S],z[S]=W}y(z)},k=()=>{s&&s(),n()},I=w=>{d(j=>({...j,selectedMode:w}))},E=w=>{const j=w.target.value;g(S=>({...S,externalLink:j}))},B=w=>{const j=w.target.value;g(S=>({...S,filename:j}))},h=w=>{g(j=>({...j,type:w}))},f=async()=>{if(!x.current||!x.current.files)return;const w=[];for(const j of x.current.files)w.push(j);y(w)},R=()=>{if(u.selectedMode==="local-file"){if(!x.current||!x.current.files||x.current.files.length===0)return!1}else if(u.selectedMode==="external-link"&&(r.filename===""||r.externalLink===""||r.type===""))return!1;return!0},H=async()=>{if(u.uploadingFlag)return;d(j=>({...j,uploadingFlag:!0}));const w=[];try{if(u.selectedMode==="local-file"){if(!x.current||!x.current.files)return;const j=Array.from(x.current.files);for(const S of m){if(!j.find(te=>te.name===S.name))continue;const W=await a.createResourceWithBlob(S);w.push(W)}}else{const j=await a.createResource(r);w.push(j)}}catch(j){console.error(j),xe.error(typeof j=="string"?j:j.response.data.message)}i&&i(w),n()};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"dialog-header-container",children:[t.jsx("p",{className:"title-text",children:e("resource.create-dialog.title")}),t.jsx(we,{size:"sm",onClick:k,children:t.jsx(M.X,{className:"w-5 h-auto"})})]}),t.jsxs("div",{className:"dialog-content-container !w-80",children:[t.jsx(ot,{className:"!mb-1",level:"body-md",children:e("resource.create-dialog.upload-method")}),t.jsxs(Vo,{className:"w-full mb-2",onChange:(w,j)=>I(j),value:u.selectedMode,startDecorator:t.jsx(M.File,{className:"w-4 h-auto"}),children:[t.jsx(Jt,{value:"local-file",children:e("resource.create-dialog.local-file.option")}),t.jsx(Jt,{value:"external-link",children:e("resource.create-dialog.external-link.option")})]}),u.selectedMode==="local-file"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"w-full relative bg-blue-50 dark:bg-zinc-900 rounded-md flex flex-row justify-center items-center py-8",children:[t.jsx("label",{htmlFor:"files",className:"p-2 px-4 text-sm text-white cursor-pointer bg-blue-500 block rounded hover:opacity-80",children:e("resource.create-dialog.local-file.choose")}),t.jsx("input",{className:"absolute inset-0 w-full h-full opacity-0",ref:x,onChange:f,type:"file",id:"files",multiple:!0,accept:"*"})]}),t.jsx(Bo,{size:"sm",sx:{width:"100%"},children:m.map((w,j)=>t.jsxs(jt,{className:"flex justify-between",children:[t.jsx(ot,{noWrap:!0,children:w.name}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>{C(w.name,"up")},disabled:j===0,className:"disabled:opacity-50",children:t.jsx(M.ArrowUp,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{C(w.name,"down")},disabled:j===m.length-1,className:"disabled:opacity-50",children:t.jsx(M.ArrowDown,{className:"w-4 h-4"})})]})]},w.name))})]}),u.selectedMode==="external-link"&&t.jsxs(t.Fragment,{children:[t.jsx(ot,{className:"!mb-1",level:"body-md",children:e("resource.create-dialog.external-link.link")}),t.jsx(Kt,{className:"mb-2",placeholder:e("resource.create-dialog.external-link.link-placeholder"),value:r.externalLink,onChange:E,fullWidth:!0}),t.jsx(ot,{className:"!mb-1",level:"body-md",children:e("resource.create-dialog.external-link.file-name")}),t.jsx(Kt,{className:"mb-2",placeholder:e("resource.create-dialog.external-link.file-name-placeholder"),value:r.filename,onChange:B,fullWidth:!0}),t.jsx(ot,{className:"!mb-1",level:"body-md",children:e("resource.create-dialog.external-link.type")}),t.jsx(Ko,{className:"w-full",size:"sm",placeholder:e("resource.create-dialog.external-link.type-placeholder"),freeSolo:!0,options:Ys,onChange:(w,j)=>h(j||"")})]}),t.jsxs("div",{className:"mt-2 w-full flex flex-row justify-end items-center space-x-1",children:[t.jsx(Ce,{variant:"plain",color:"neutral",onClick:k,children:e("common.cancel")}),t.jsx(Ce,{onClick:H,loading:u.uploadingFlag,disabled:!R(),children:e("common.create")})]})]})]})};function Zs(o){Xe({dialogName:"create-resource-dialog"},Qs,o)}const en=o=>{const{destroy:e,onConfirm:n}=o,s=ze(),i=Yt(),[a,u]=p.useState(""),[d,r]=p.useState(!0),[g,m]=p.useState([]),[y,x]=p.useState([]),[C,k]=p.useState(!1),I=g.filter(f=>!y.includes(f));br(async()=>{r(!0);try{const f=[`creator == "${i.name}"`,'row_status == "NORMAL"'];a&&f.push(`content_search == [${JSON.stringify(a)}]`);const{memos:R}=await He.listMemos({pageSize:xr,filter:f.length>0?f.join(" && "):void 0});m(R)}catch(f){console.error(f),xe.error(f.response.data.message)}r(!1)},300,[a]);const E=f=>{const R=f.toLowerCase().indexOf(a.toLowerCase());if(R===-1)return f;let H=f.slice(0,R);H.length>20&&(H="..."+H.slice(H.length-20));const w=f.slice(R,R+a.length);let j=f.slice(R+a.length);return j.length>20&&(j=j.slice(0,20)+"..."),t.jsxs(t.Fragment,{children:[H,t.jsx("mark",{className:"font-medium",children:w}),j]})},B=()=>{e()},h=async()=>{n(y.map(f=>f.id),C),e()};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"dialog-header-container !w-96",children:[t.jsx("p",{className:"title-text",children:"Add references"}),t.jsx(we,{size:"sm",onClick:()=>e(),children:t.jsx(M.X,{className:"w-5 h-auto"})})]}),t.jsxs("div",{className:"dialog-content-container max-w-[24rem]",children:[t.jsx(Ko,{className:"w-full",size:"md",clearOnBlur:!0,disableClearable:!0,placeholder:"Search content",noOptionsText:"No memos found",options:I,loading:d,inputValue:a,value:y,multiple:!0,onInputChange:(f,R)=>u(R.trim()),getOptionKey:f=>f.name,getOptionLabel:f=>f.content,isOptionEqualToValue:(f,R)=>f.id===R.id,renderOption:(f,R)=>t.jsx(Ss,{...f,children:t.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[t.jsx("p",{className:"text-xs text-gray-400 select-none",children:st(R.displayTime)}),t.jsx("p",{className:"mt-0.5 text-sm leading-5 line-clamp-2",children:a?E(R.content):R.content})]})}),renderTags:f=>f.map(R=>t.jsx(Ho,{className:"!max-w-full !rounded",variant:"outlined",color:"neutral",children:t.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[t.jsx("p",{className:"text-xs text-gray-400 select-none",children:st(R.displayTime)}),t.jsx("span",{className:"w-full text-sm leading-5 truncate",children:R.content})]})},R.name)),onChange:(f,R)=>x(R)}),t.jsx("div",{className:"mt-3",children:t.jsx($r,{label:"Use as Embedded Content",checked:C,onChange:f=>k(f.target.checked)})}),t.jsxs("div",{className:"mt-4 w-full flex flex-row justify-end items-center space-x-1",children:[t.jsx(Ce,{variant:"plain",color:"neutral",onClick:B,children:s("common.cancel")}),t.jsx(Ce,{onClick:h,disabled:y.length===0,children:s("common.confirm")})]})]})]})};function tn(o){Xe({className:"create-memo-relation-dialog",dialogName:"create-memo-relation-dialog"},en,o)}const Go=p.createContext({relationList:[],setRelationList:()=>{}}),on=o=>{const{editorRef:e}=o,n=Ge(),s=p.useContext(Go),i=()=>{tn({onConfirm:(a,u)=>{if(u){if(!e.current){No.error("Failed to embed memo");return}const d=e.current.getCursorPosition(),r=e.current.getContent().slice(0,d);r!==""&&!r.endsWith(`
`)&&e.current.insertText(`
`);for(const g of a){const m=n.getMemoById(g);e.current.insertText(`![[memos/${m.name}]]
`)}setTimeout(()=>{var g,m;(g=e.current)==null||g.scrollToCursor(),(m=e.current)==null||m.focus()});return}s.setRelationList(dr([...a.map(d=>({memoId:s.memoId||Ke,relatedMemoId:d,type:Je.REFERENCE})),...s.relationList].filter(d=>d.relatedMemoId!==(s.memoId||Ke)),"relatedMemoId"))}})};return t.jsx(we,{size:"sm",onClick:i,children:t.jsx(M.Link,{className:"w-5 h-5 mx-auto"})})},rn=({content:o,destroy:e})=>{const n=()=>{e()};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"dialog-header-container",children:[t.jsx("div",{className:"flex flex-row justify-start items-center",children:t.jsx("p",{className:"text-black opacity-80 dark:text-gray-200",children:"Preview"})}),t.jsx(we,{size:"sm",onClick:n,children:t.jsx(M.X,{className:"w-5 h-auto"})})]}),t.jsx("div",{className:"flex flex-col justify-start items-start max-w-full w-[32rem]",children:o!==""?t.jsx(to,{content:o}):t.jsx("p",{className:"text-gray-400 dark:text-gray-600",children:"Nothing to preview"})})]})};function sn(o){Xe({className:"preview-markdown-dialog",dialogName:"preview-markdown-dialog",containerClassName:"dark:!bg-zinc-800"},rn,{content:o})}const nn=o=>{const{editorRef:e}=o,n=()=>{if(!e.current)return;const a=e.current.getCursorPosition(),u=e.current.getContent().slice(0,a);u===""||u.endsWith(`
`)?e.current.insertText("","```\n","\n```"):e.current.insertText("","\n```\n","\n```"),setTimeout(()=>{var d,r;(d=e.current)==null||d.scrollToCursor(),(r=e.current)==null||r.focus()})},s=()=>{if(!e.current)return;const a=e.current.getCursorPosition(),u=e.current.getCursorLineNumber(),d=e.current.getLine(u);let r="",g=0;if(/^- \[( |x|X)\] /.test(d))r=d.replace(/^- \[( |x|X)\] /,""),g=-6;else if(/^\d+\. |- /.test(d)){const m=d.match(/^\d+\. |- /)??[""];r=d.replace(/^\d+\. |- /,"- [ ] "),g=-m[0].length+6}else r="- [ ] "+d,g=6;e.current.setLine(u,r),e.current.setCursorPosition(a+g),setTimeout(()=>{var m,y;(m=e.current)==null||m.scrollToCursor(),(y=e.current)==null||y.focus()})},i=()=>{var u,d;if((((u=e.current)==null?void 0:u.getContent())??"")===""){No.error("Nothing to preview");return}sn(((d=e.current)==null?void 0:d.getContent())??"")};return t.jsxs(Lo,{children:[t.jsx(Do,{slots:{root:we},slotProps:{root:{size:"sm"}},children:t.jsx(M.SquareSlash,{className:"w-5 h-5 mx-auto"})}),t.jsxs(To,{className:"text-sm",size:"sm",placement:"bottom-start",children:[t.jsxs(_t,{onClick:n,children:[t.jsx(M.Code2,{className:"w-4 h-auto"}),t.jsx("span",{children:"Code block"})]}),t.jsxs(_t,{onClick:s,children:[t.jsx(M.CheckSquare,{className:"w-4 h-auto"}),t.jsx("span",{children:"Checkbox"})]}),t.jsxs(_t,{onClick:i,children:[t.jsx(M.GanttSquare,{className:"w-4 h-auto"}),t.jsx("span",{children:"Preview"})]}),t.jsx("div",{className:"-mt-0.5 pl-2",children:t.jsx(zr,{fontSize:12,href:"https://www.usememos.com/docs/getting-started/content-syntax",target:"_blank",children:"Content syntax"})})]})]})};var Xo={};Object.defineProperty(Xo,"__esModule",{value:!0});var Ht=p,wo=hr,an=["mousedown","touchstart"],ln=function(o,e,n){n===void 0&&(n=an);var s=Ht.useRef(e);Ht.useEffect(function(){s.current=e},[e]),Ht.useEffect(function(){for(var i=function(r){var g=o.current;g&&!g.contains(r.target)&&s.current(r)},a=0,u=n;a<u.length;a++){var d=u[a];wo.on(document,d,i)}return function(){for(var r=0,g=n;r<g.length;r++){var m=g[r];wo.off(document,m,i)}}},[n,o])},cn=Xo.default=ln;const Yo=({children:o,className:e})=>{const[n,s]=p.useState(!1),i=p.useRef(null);return p.useEffect(()=>{i.current&&s(i.current.scrollWidth>i.current.clientWidth)},[]),t.jsx(qe,{title:o,placement:"top",arrow:!0,disableHoverListener:!n,children:t.jsx("div",{ref:i,className:wt("truncate",e),children:o})})},dn=o=>{const{editorRef:e}=o,n=kt(),[s,i]=p.useState(!1),a=p.useRef(null),u=n.state.tags;p.useEffect(()=>{(async()=>{try{await n.fetchTags()}catch{}})()},[]),cn(a,()=>{i(!1)});const d=r=>{var g;(g=e.current)==null||g.insertText(`#${r} `)};return t.jsxs(Lo,{open:s,onOpenChange:(r,g)=>i(g),children:[t.jsx(Do,{slots:{root:we},slotProps:{root:{size:"sm"}},children:t.jsx(M.Hash,{className:"w-5 h-5 mx-auto"})}),t.jsx(To,{className:"relative text-sm",component:"div",size:"sm",placement:"bottom-start",children:t.jsx("div",{ref:a,children:u.length>0?t.jsx("div",{className:"flex-row justify-start items-start flex-wrap px-1 max-w-[12rem] h-auto max-h-48 overflow-y-auto font-mono",children:u.map(r=>t.jsx("div",{className:"inline-flex w-auto max-w-full cursor-pointer rounded text-sm leading-5 px-1 text-gray-500 dark:text-gray-400 hover:bg-zinc-100 dark:hover:bg-zinc-800",onClick:()=>d(r),children:t.jsxs(Yo,{children:["#",r]})},r))}):t.jsx("p",{className:"italic mx-2",onClick:r=>r.stopPropagation(),children:"No tag found"})})})]})};var Qo={exports:{}};(function(o){(function(){var e=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],n=typeof window<"u",s=n&&window.mozInnerScreenX!=null;function i(a,u,d){if(!n)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var r=d&&d.debug||!1;if(r){var g=document.querySelector("#input-textarea-caret-position-mirror-div");g&&g.parentNode.removeChild(g)}var m=document.createElement("div");m.id="input-textarea-caret-position-mirror-div",document.body.appendChild(m);var y=m.style,x=window.getComputedStyle?window.getComputedStyle(a):a.currentStyle,C=a.nodeName==="INPUT";y.whiteSpace="pre-wrap",C||(y.wordWrap="break-word"),y.position="absolute",r||(y.visibility="hidden"),e.forEach(function(E){C&&E==="lineHeight"?y.lineHeight=x.height:y[E]=x[E]}),s?a.scrollHeight>parseInt(x.height)&&(y.overflowY="scroll"):y.overflow="hidden",m.textContent=a.value.substring(0,u),C&&(m.textContent=m.textContent.replace(/\s/g," "));var k=document.createElement("span");k.textContent=a.value.substring(u)||".",m.appendChild(k);var I={top:k.offsetTop+parseInt(x.borderTopWidth),left:k.offsetLeft+parseInt(x.borderLeftWidth),height:parseInt(x.lineHeight)};return r?k.style.backgroundColor="#aaa":document.body.removeChild(m),I}o.exports=i})()})(Qo);var un=Qo.exports;const pn=ur(un),mn=({editorRef:o,editorActions:e})=>{const[n,s]=p.useState(null),i=()=>s(null),{state:a}=kt(),u=p.useRef(a.tags);u.current=a.tags;const[d,r]=p.useState(0),g=p.useRef(d);g.current=d;const m=()=>{const h=o.current;if(!h)return["",0];const f=h.selectionEnd,R=h.value.slice(0,f).match(/\S*$/)||{0:"",index:f},H=h.value.slice(f).match(/^\S*/)||{0:""};return[R[0]+H[0],R.index??f]},y=p.useRef([]);y.current=(()=>{const h=m()[0].slice(1).toLowerCase(),f=(H,w)=>{const j=H.toLowerCase(),S=w.toLowerCase();let z=0;for(let W=0;W<j.length;W++)if(j[W]===S[z]&&(z++,z===S.length))return!0;return!1};return u.current.filter(H=>f(H,h)).slice(0,5)})();const x=p.useRef(!1);x.current=!!(n&&y.current.length>0);const C=h=>{if(!e||!("current"in e)||!e.current)return;const[f,R]=m();e.current.removeText(R,f.length),e.current.insertText(`#${h}`),i()},k=h=>{if(!x.current)return;const f=y.current,R=g.current;["Escape","ArrowLeft","ArrowRight"].includes(h.code)&&i(),h.code==="ArrowDown"&&(r((R+1)%f.length),h.preventDefault(),h.stopPropagation()),h.code==="ArrowUp"&&(r((R-1+f.length)%f.length),h.preventDefault(),h.stopPropagation()),["Enter","Tab"].includes(h.code)&&(C(f[R]),h.preventDefault(),h.stopPropagation())},I=()=>{if(!o.current)return;r(0);const[h,f]=m();h.startsWith("#")&&!h.slice(1).includes("#")?s(pn(o.current,f)):i()},E=p.useRef(!1),B=()=>{const h=o.current;!h||E.current||(h.addEventListener("click",i),h.addEventListener("blur",i),h.addEventListener("keydown",k),h.addEventListener("input",I),E.current=!0)};return p.useEffect(B,[!!o.current]),!x.current||!n?null:t.jsx("div",{className:"z-20 p-1 mt-1 -ml-2 absolute max-w-[12rem] gap-px rounded font-mono flex flex-col justify-start items-start overflow-auto shadow bg-zinc-100 dark:bg-zinc-700",style:{left:n.left,top:n.top+n.height},children:y.current.map((h,f)=>t.jsx("div",{onMouseDown:()=>C(h),className:wt("rounded p-1 px-2 w-full truncate text-sm dark:text-gray-300 cursor-pointer hover:bg-zinc-200 dark:hover:bg-zinc-800",f===d?"bg-zinc-300 dark:bg-zinc-700":""),children:t.jsxs(Yo,{children:["#",h]})},h))})},fn=p.forwardRef(function(e,n){var y;const{className:s,initialContent:i,placeholder:a,onPaste:u,onContentChange:d}=e,r=p.useRef(null);p.useEffect(()=>{r.current&&i&&(r.current.value=i,d(i))},[]),p.useEffect(()=>{r.current&&g()},[(y=r.current)==null?void 0:y.value]);const g=()=>{r.current&&(r.current.style.height="auto",r.current.style.height=(r.current.scrollHeight??0)+"px")};p.useImperativeHandle(n,()=>({focus:()=>{var x;(x=r.current)==null||x.focus()},scrollToCursor:()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},insertText:(x="",C="",k="")=>{if(!r.current)return;const I=r.current.selectionStart,E=r.current.selectionEnd,B=r.current.value,h=B.slice(0,I)+C+(x||B.slice(I,E))+k+B.slice(E);r.current.value=h,r.current.focus(),r.current.selectionEnd=E+C.length+x.length,d(r.current.value),g()},removeText:(x,C)=>{if(!r.current)return;const k=r.current.value,I=k.slice(0,x)+k.slice(x+C);r.current.value=I,r.current.focus(),r.current.selectionEnd=x,d(r.current.value),g()},setContent:x=>{r.current&&(r.current.value=x,d(r.current.value),g())},getContent:()=>{var x;return((x=r.current)==null?void 0:x.value)??""},getCursorPosition:()=>{var x;return((x=r.current)==null?void 0:x.selectionStart)??0},getSelectedContent:()=>{var k,I,E;const x=(k=r.current)==null?void 0:k.selectionStart,C=(I=r.current)==null?void 0:I.selectionEnd;return((E=r.current)==null?void 0:E.value.slice(x,C))??""},setCursorPosition:(x,C)=>{var I;const k=isNaN(C)?x:C;(I=r.current)==null||I.setSelectionRange(x,k)},getCursorLineNumber:()=>{var k,I;const x=((k=r.current)==null?void 0:k.selectionStart)??0;return(((I=r.current)==null?void 0:I.value.slice(0,x).split(`
`))??[]).length-1},getLine:x=>{var C;return((C=r.current)==null?void 0:C.value.split(`
`)[x])??""},setLine:(x,C)=>{var I;const k=((I=r.current)==null?void 0:I.value.split(`
`))??[];k[x]=C,r.current&&(r.current.value=k.join(`
`),r.current.focus(),d(r.current.value),g())}}),[]);const m=p.useCallback(()=>{var x;d(((x=r.current)==null?void 0:x.value)??""),g()},[]);return t.jsxs("div",{className:wt("flex flex-col justify-start items-start relative w-full h-auto bg-inherit dark:text-gray-300",s),children:[t.jsx("textarea",{className:"w-full h-full max-h-[300px] my-1 text-base resize-none overflow-x-hidden overflow-y-auto bg-transparent outline-none whitespace-pre-wrap word-break",rows:1,placeholder:a,ref:r,onPaste:u,onInput:m}),t.jsx(mn,{editorRef:r,editorActions:n})]})}),hn=o=>{const{relationList:e,setRelationList:n}=o,s=Ge(),[i,a]=p.useState([]);p.useEffect(()=>{(async()=>{const d=e.filter(g=>g.type===Je.REFERENCE).map(async g=>await s.getOrFetchMemoById(g.relatedMemoId,{skipStore:!0})),r=await Promise.all(d);a(r)})()},[e]);const u=async d=>{n(e.filter(r=>r.relatedMemoId!==d.id))};return t.jsx(t.Fragment,{children:i.length>0&&t.jsx("div",{className:"w-full flex flex-row gap-2 mt-2 flex-wrap",children:i.map(d=>t.jsxs("div",{className:"w-auto max-w-xs overflow-hidden flex flex-row justify-start items-center bg-zinc-100 dark:bg-zinc-900 hover:opacity-80 rounded-md text-sm p-1 px-2 text-gray-500 dark:text-gray-400 cursor-pointer hover:line-through",onClick:()=>u(d),children:[t.jsx(M.Link,{className:"w-4 h-auto shrink-0 opacity-80"}),t.jsx("span",{className:"mx-1 max-w-full text-ellipsis whitespace-nowrap overflow-hidden",children:d.content}),t.jsx(M.X,{className:"w-4 h-auto cursor-pointer shrink-0 opacity-60 hover:opacity-100"})]},d.name))})})},gn=o=>{const{resourceList:e,setResourceList:n}=o,s=async i=>{n(e.filter(a=>a.id!==i))};return t.jsx(t.Fragment,{children:e.length>0&&t.jsx("div",{className:"w-full flex flex-row justify-start flex-wrap gap-2 mt-2",children:e.map(i=>t.jsxs("div",{className:"max-w-full flex flex-row justify-start items-center flex-nowrap gap-x-1 bg-zinc-100 dark:bg-zinc-900 px-2 py-1 rounded text-gray-500 dark:text-gray-400",children:[t.jsx(Fr,{resource:i,className:"!w-4 !h-4 !opacity-100"}),t.jsx("span",{className:"text-sm max-w-[8rem] truncate",children:i.filename}),t.jsx(M.X,{className:"w-4 h-auto cursor-pointer opacity-60 hover:opacity-100",onClick:()=>s(i.id)})]},i.id))})})},xn=(o,e)=>{if(o.key==="b"){const n="**";o.preventDefault(),jo(e,n)}else if(o.key==="i"){const n="*";o.preventDefault(),jo(e,n)}else o.key==="k"&&(o.preventDefault(),Zo(e))},Zo=(o,e)=>{const n=o.getCursorPosition(),s=o.getSelectedContent(),i="url";if(e=e??i,o.insertText(`[${s}](${e})`),e===i){const a=n+s.length+3;o.setCursorPosition(a,a+e.length)}},jo=(o,e)=>{const n=o.getCursorPosition(),s=o.getSelectedContent();if(s.startsWith(e)&&s.endsWith(e)){o.insertText(s.slice(e.length,-e.length));const i=s.length-e.length*2;o.setCursorPosition(n,n+i)}else o.insertText(`${e}${s}${e}`),o.setCursorPosition(n+e.length,n+e.length+s.length)},vn=o=>{const{className:e,editorClassName:n,cacheKey:s,memoId:i,parentMemoId:a,autoFocus:u,onConfirm:d}=o,{i18n:r}=Ro(),g=ze(),m=`memo-editor-${s}`,[y,x]=Ar(m,""),{state:{systemStatus:C}}=Qt(),k=Zt(),I=Ge(),E=Jo(),B=kt(),[h,f]=p.useState({memoVisibility:We.PRIVATE,resourceList:[],relationList:o.relationList??[],isUploadingResource:!1,isRequesting:!1}),[R,H]=p.useState(!1),w=p.useRef(null),j=k.userSetting,S=i?h.relationList.filter(v=>v.memoId===i&&v.relatedMemoId!==i&&v.type===Je.REFERENCE):h.relationList.filter(v=>v.type===Je.REFERENCE);p.useEffect(()=>{var v;(v=w.current)==null||v.setContent(y||"")},[]),p.useEffect(()=>{u&&je()},[u]),p.useEffect(()=>{let v=j.memoVisibility;C.disablePublicMemos&&v==="PUBLIC"&&(v="PRIVATE"),f(T=>({...T,memoVisibility:Cr(v)}))},[j.memoVisibility,C.disablePublicMemos]),p.useEffect(()=>{i&&I.getOrFetchMemoById(i??Ke).then(v=>{var T;v&&(je(),f(O=>({...O,memoVisibility:v.visibility,resourceList:v.resources,relationList:v.relations})),y||(T=w.current)==null||T.setContent(v.content??""))})},[i]);const z=v=>{if(!w.current)return;if(v.ctrlKey||v.metaKey){if(v.key==="Enter"){Le();return}xn(v,w.current)}if(v.key==="Tab"){v.preventDefault();const O=" ".repeat(po),ne=w.current.getCursorPosition(),Q=w.current.getSelectedContent();w.current.insertText(O),Q&&w.current.setCursorPosition(ne+po);return}},W=v=>{f(T=>({...T,memoVisibility:v}))},te=()=>{Zs({onConfirm:v=>{f(T=>({...T,resourceList:[...T.resourceList,...v]}))}})},$=v=>{f(T=>({...T,resourceList:v}))},pe=v=>{f(T=>({...T,relationList:v}))},ve=async v=>{f(O=>({...O,isUploadingResource:!0}));let T;try{T=await E.createResourceWithBlob(v)}catch(O){console.error(O),xe.error(typeof O=="string"?O:O.response.data.message)}return f(O=>({...O,isUploadingResource:!1})),T},ge=async v=>{const T=[];for(const O of v){const ne=await ve(O);ne&&(T.push(ne),i&&await E.updateResource({resource:mr.fromPartial({id:ne.id,memoId:i}),updateMask:["memo_id"]}))}T.length>0&&f(O=>({...O,resourceList:[...O.resourceList,...T]}))},J=async v=>{v.dataTransfer&&v.dataTransfer.files.length>0&&(v.preventDefault(),await ge(v.dataTransfer.files))},Ne=async v=>{v.clipboardData&&v.clipboardData.files.length>0?(v.preventDefault(),await ge(v.clipboardData.files)):w.current!=null&&w.current.getSelectedContent().length!=0&&pr(v.clipboardData.getData("Text"))&&(v.preventDefault(),Zo(w.current,v.clipboardData.getData("Text")))},Re=v=>{H(v!==""),v!==""?x(v):localStorage.removeItem(m)},Le=async()=>{var O,ne;if(h.isRequesting)return;f(Q=>({...Q,isRequesting:!0}));const v=((O=w.current)==null?void 0:O.getContent())??"";try{if(i&&i!==Ke){const Q=await I.getOrFetchMemoById(i??Ke);if(Q){const V=await I.updateMemo({id:Q.id,content:v,visibility:h.memoVisibility},["content","visibility"]);await He.setMemoResources({id:V.id,resources:h.resourceList}),await He.setMemoRelations({id:V.id,relations:h.relationList}),await I.getOrFetchMemoById(V.id,{skipCache:!0}),d&&d(V.id)}}else{const V=await(a?He.createMemoComment({id:a,create:{content:v,visibility:h.memoVisibility}}).then(({memo:re})=>re):I.createMemo({content:v,visibility:h.memoVisibility}));await He.setMemoResources({id:V.id,resources:h.resourceList}),await He.setMemoRelations({id:V.id,relations:h.relationList}),await I.getOrFetchMemoById(V.id,{skipCache:!0}),d&&d(V.id)}(ne=w.current)==null||ne.setContent("")}catch(Q){console.error(Q),xe.error(Q.details)}const T=Xs(v);await B.batchUpsertTag(T),f(Q=>({...Q,isRequesting:!1,resourceList:[],relationList:[]}))},je=()=>{var v;(v=w.current)==null||v.focus()},be=p.useMemo(()=>({className:n??"",initialContent:"",placeholder:g("editor.placeholder"),onContentChange:Re,onPaste:Ne}),[r.language]),Ye=(R||h.resourceList.length>0)&&!h.isUploadingResource&&!h.isRequesting;return t.jsx(Go.Provider,{value:{relationList:h.relationList,setRelationList:v=>{f(T=>({...T,relationList:v}))},memoId:i},children:t.jsxs("div",{className:`${e??""} relative w-full flex flex-col justify-start items-start bg-white dark:bg-zinc-800 px-4 pt-4 rounded-lg border border-gray-200 dark:border-zinc-700`,tabIndex:0,onKeyDown:z,onDrop:J,onFocus:je,children:[t.jsx(fn,{ref:w,...be}),t.jsx(gn,{resourceList:h.resourceList,setResourceList:$}),t.jsx(hn,{relationList:S,setRelationList:pe}),t.jsx("div",{className:"relative w-full flex flex-row justify-between items-center pt-2",onFocus:v=>v.stopPropagation(),children:t.jsxs("div",{className:"flex flex-row justify-start items-center opacity-80",children:[t.jsx(dn,{editorRef:w}),t.jsx(nn,{editorRef:w}),t.jsx(we,{size:"sm",onClick:te,children:t.jsx(M.Image,{className:"w-5 h-5 mx-auto"})}),t.jsx(on,{editorRef:w})]})}),t.jsx(Gt,{className:"!mt-2"}),t.jsxs("div",{className:"w-full flex flex-row justify-between items-center py-3 dark:border-t-zinc-500",children:[t.jsx("div",{className:"relative flex flex-row justify-start items-center",onFocus:v=>v.stopPropagation(),children:t.jsx(Vo,{variant:"plain",value:h.memoVisibility,startDecorator:t.jsx(Eo,{visibility:h.memoVisibility}),onChange:(v,T)=>{T&&W(T)},children:[We.PRIVATE,We.PROTECTED,We.PUBLIC].map(v=>t.jsx(Jt,{value:v,className:"whitespace-nowrap",children:g(`memo.visibility.${Ao(v).toLowerCase()}`)},v))})}),t.jsx("div",{className:"shrink-0 flex flex-row justify-end items-center",children:t.jsx(Ce,{disabled:!Ye,loading:h.isRequesting,endDecorator:t.jsx(M.Send,{className:"w-4 h-auto"}),onClick:Le,children:g("editor.save")})})]})]})})},bn=({memoId:o,cacheKey:e,relationList:n,destroy:s})=>{const i=Qt(),a=kt(),{systemStatus:u}=i.state;p.useEffect(()=>{a.fetchTags()},[]);const d=()=>{s()};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"w-full flex flex-row justify-between items-center mb-2",children:[t.jsxs("div",{className:"flex flex-row justify-start items-center",children:[t.jsx("img",{className:"w-6 h-auto rounded-full shadow",src:u.customizedProfile.logoUrl,alt:""}),t.jsx("p",{className:"ml-1 text-lg opacity-80 dark:text-gray-300",children:u.customizedProfile.name})]}),t.jsx(we,{size:"sm",onClick:d,children:t.jsx(M.X,{className:"w-5 h-auto"})})]}),t.jsx("div",{className:"flex flex-col justify-start items-start max-w-full w-[36rem]",children:t.jsx(vn,{className:"border-none !p-0 -mb-2",cacheKey:`memo-editor-${e||o}`,memoId:o,relationList:n,onConfirm:d,autoFocus:!0})})]})};function Io(o={}){Xe({className:"memo-editor-dialog",dialogName:"memo-editor-dialog",containerClassName:"dark:!bg-zinc-800"},bn,o)}const yn=o=>{const{memo:e,relationList:n}=o,s=Ge(),[i,a]=p.useState([]),[u,d]=p.useState([]);return p.useEffect(()=>{(async()=>{const r=await Promise.all(n.filter(m=>m.memoId===e.id&&m.relatedMemoId!==e.id).map(m=>s.getOrFetchMemoById(m.relatedMemoId,{skipStore:!0})));a(r);const g=await Promise.all(n.filter(m=>m.memoId!==e.id&&m.relatedMemoId===e.id).map(m=>s.getOrFetchMemoById(m.memoId,{skipStore:!0})));d(g)})()},[e,n]),t.jsxs(t.Fragment,{children:[i.length>0&&t.jsx("div",{className:"w-full mt-2 flex flex-row justify-start items-center flex-wrap gap-2",children:i.map(r=>t.jsx("div",{className:"block w-auto max-w-[50%]",children:t.jsxs(qt,{className:"px-2 border rounded-md w-auto text-sm leading-6 flex flex-row justify-start items-center flex-nowrap text-gray-600 dark:text-gray-400 dark:border-zinc-700 dark:bg-zinc-900 hover:shadow hover:opacity-80",to:`/m/${r.name}`,unstable_viewTransition:!0,children:[t.jsx(qe,{title:"Reference",placement:"top",children:t.jsx(M.Link,{className:"w-4 h-auto shrink-0 opacity-70"})}),t.jsx("span",{className:"truncate ml-1",children:r.content})]})},r.name))}),u.length>0&&t.jsx("div",{className:"w-full mt-2 flex flex-row justify-start items-center flex-wrap gap-2",children:u.map(r=>t.jsx("div",{className:"block w-auto max-w-[50%]",children:t.jsxs(qt,{className:"px-2 border rounded-md w-auto text-sm leading-6 flex flex-row justify-start items-center flex-nowrap text-gray-600 dark:text-gray-400 dark:border-zinc-700 dark:bg-zinc-900 hover:shadow hover:opacity-80",to:`/m/${r.name}`,unstable_viewTransition:!0,children:[t.jsx(qe,{title:"Backlink",placement:"top",children:t.jsx(M.Milestone,{className:"w-4 h-auto shrink-0 opacity-70"})}),t.jsx("span",{className:"truncate ml-1",children:r.content})]})},r.name))})]})},Cn=p.memo(yn),Wt=new Map,ko=async(o,e=!0)=>{if(e&&Wt.has(o))return Promise.resolve(Wt.get(o));const s=await(await fetch(o)).blob();return new Promise(i=>{const a=new FileReader;a.onloadend=()=>{const u=a.result;Wt.set(o,u),i(u)},a.readAsDataURL(s)})},er=async(o,e)=>{if(!o||!e)return;if(o.tagName==="IMG"){const s=o.getAttribute("src")??"";let i=!1;try{e.src=await ko(s)}catch{i=!0}if(i)try{e.src=await ko(`/o/get/image?url=${s}`)}catch{}}const n=window.getComputedStyle(o);for(const s of n)e.style.setProperty(s,n.getPropertyValue(s),n.getPropertyPriority(s));for(let s=0;s<e.childElementCount;s++)await er(o.children[s],e.children[s])},wn=async o=>{const e=document.createElement(o.tagName);return e.innerHTML=o.innerHTML,await er(o,e),e},jn=(o,e)=>new Promise((n,s)=>{o.loading="eager",o.onload=()=>{setTimeout(()=>{n()},200)},o.onerror=()=>{s("Image load failed")},o.src=e}),tr=o=>{const{width:e,height:n}=window.getComputedStyle(o);return{width:parseInt(e.replace("px","")),height:parseInt(n.replace("px",""))}},In=o=>{const e=new XMLSerializer().serializeToString(o);return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(e)}`},kn=(o,e,n)=>{const s="http://www.w3.org/2000/svg",i=document.createElementNS(s,"svg");i.setAttribute("width",`${o}`),i.setAttribute("height",`${e}`),i.setAttribute("viewBox",`0 0 ${o} ${e}`);const a=document.createElementNS(s,"foreignObject");return a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("externalResourcesRequired","true"),a.appendChild(n),i.appendChild(a),i},Sn=async(o,e)=>{const{width:n,height:s}=tr(o),i=await wn(o);e!=null&&e.backgroundColor&&(i.style.backgroundColor=e.backgroundColor);const a=kn(n,s,i);return In(a)},Nn=async(o,e)=>{const n=(e==null?void 0:e.pixelRatio)||1,{width:s,height:i}=tr(o),a=document.createElement("canvas"),u=a.getContext("2d");if(!u)return Promise.reject("Canvas error");a.width=s*n,a.height=i*n,a.style.width=`${s}`,a.style.height=`${i}`,e!=null&&e.backgroundColor&&(u.fillStyle=e.backgroundColor,u.fillRect(0,0,a.width,a.height));const d=await Sn(o,e),r=new Image;return r.style.zIndex="-1",r.style.position="fixed",r.style.top="0",document.body.append(r),await jn(r,d),u.drawImage(r,0,0,a.width,a.height),r.remove(),a},Rn=async(o,e)=>(await Nn(o,e)).toDataURL(),Ln=o=>{const{memo:e,destroy:n}=o,s=ze(),i=Zt(),a=ho(!1),u=ho(),d=p.useRef(null),r=i.getUserByUsername(rt(e.creator));p.useEffect(()=>{(async()=>(await i.getOrFetchUserByUsername(rt(e.creator)),u.setFinish()))()},[]);const g=()=>{n()},m=()=>{d.current&&(a.setLoading(),Rn(d.current,{pixelRatio:window.devicePixelRatio*2}).then(C=>{uo(C,`memos-${st(Date.now())}.png`),a.setFinish(),URL.revokeObjectURL(C)}).catch(C=>{console.error(C)}))},y=()=>{const C=new Blob([e.content],{type:"text/plain;charset=utf-8"}),k=URL.createObjectURL(C);uo(k,`memos-${st(Date.now())}.md`),URL.revokeObjectURL(k)},x=()=>{Oo(`${window.location.origin}/m/${e.name}`),e.visibility!==We.PUBLIC?xe.success(s("message.succeed-copy-link-not-public")):xe.success(s("message.succeed-copy-link"))};return u.isLoading?null:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"dialog-header-container py-3 px-4 !mb-0 rounded-t-lg",children:[t.jsxs("p",{className:"",children:[s("common.share")," Memo"]}),t.jsx(we,{size:"sm",onClick:g,children:t.jsx(M.X,{className:"w-5 h-auto"})})]}),t.jsxs("div",{className:"dialog-content-container w-full flex flex-col justify-start items-start relative",children:[t.jsxs("div",{className:"px-4 pb-3 w-full flex flex-row justify-start items-center space-x-2",children:[t.jsxs(Ce,{color:"neutral",variant:"outlined",disabled:a.isLoading,onClick:m,children:[a.isLoading?t.jsx(M.Loader,{className:"w-4 h-auto mr-1 animate-spin"}):t.jsx(M.Download,{className:"w-4 h-auto mr-1"}),s("common.image")]}),t.jsxs(Ce,{color:"neutral",variant:"outlined",onClick:y,children:[t.jsx(M.File,{className:"w-4 h-auto mr-1"}),s("common.file")]}),t.jsxs(Ce,{color:"neutral",variant:"outlined",onClick:x,children:[t.jsx(M.Link,{className:"w-4 h-auto mr-1"}),s("common.link")]})]}),t.jsx("div",{className:"w-full border-t dark:border-zinc-700 overflow-clip",children:t.jsxs("div",{className:"w-full h-auto select-none relative flex flex-col justify-start items-start bg-white dark:bg-zinc-800",ref:d,children:[t.jsx("span",{className:"w-full px-6 pt-5 pb-2 text-sm text-gray-500",children:st(e.displayTime)}),t.jsxs("div",{className:"w-full px-6 text-base pb-4",children:[t.jsx(to,{memoId:e.id,content:e.content,readonly:!0,disableFilter:!0}),t.jsx(Mo,{resources:e.resources})]}),t.jsxs("div",{className:"flex flex-row justify-between items-center w-full bg-gray-100 dark:bg-zinc-900 py-4 px-6",children:[t.jsxs("div",{className:"flex flex-row justify-start items-center",children:[t.jsx(Po,{className:"mr-2",avatarUrl:r.avatarUrl}),t.jsx("div",{className:"w-auto grow truncate flex mr-2 flex-col justify-center items-start",children:t.jsx("span",{className:"w-full text truncate font-medium text-gray-600 dark:text-gray-300",children:r.nickname||r.username})})]}),t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"via memos"})]})]})})]})]})};function Dn(o){Xe({className:"share-memo-dialog",dialogName:"share-memo-dialog"},Ln,{memo:o})}const Tn=o=>{const{memo:e,className:n}=o,s=ze(),i=fr(),{i18n:a}=Ro(),u=Ge(),d=Zt(),r=Yt(),[g,m]=p.useState(fo(Bt(e.displayTime))),[y,x]=p.useState(d.getUserByUsername(rt(e.creator))),C=p.useRef(null),k=e.relations.filter(S=>S.type===Je.REFERENCE),I=e.creator!==(r==null?void 0:r.name);p.useEffect(()=>{(async()=>{const S=await d.getOrFetchUserByUsername(rt(e.creator));x(S)})()},[]),p.useEffect(()=>{let S=-1;return Date.now()-Bt(e.displayTime)<1e3*60*60*24&&(S=setInterval(()=>{m(fo(Bt(e.displayTime)))},1e3*1)),()=>{clearInterval(S)}},[a.language]);const E=S=>{S.altKey?Gs(e.id):i(`/m/${e.name}`)},B=async()=>{try{e.pinned?await u.updateMemo({id:e.id,pinned:!1},["pinned"]):await u.updateMemo({id:e.id,pinned:!0},["pinned"])}catch{}},h=()=>{Io({memoId:e.id,cacheKey:`${e.id}-${e.updateTime}`})},f=()=>{Io({relationList:[{memoId:Ke,relatedMemoId:e.id,type:Je.REFERENCE}]})},R=async()=>{try{await u.updateMemo({id:e.id,rowStatus:gr.ARCHIVED},["row_status"])}catch(S){console.error(S),xe.error(S.response.data.message)}},H=async()=>{vr({title:s("memo.delete-memo"),content:s("memo.delete-confirm"),style:"danger",dialogName:"delete-memo-dialog",onConfirm:async()=>{await u.deleteMemo(e.id)}})},w=()=>{Oo(e.name),xe.success("Copied to clipboard!")},j=p.useCallback(async S=>{const z=S.target;if(z.tagName==="IMG"){const W=z.getAttribute("src");W&&_r([W],0)}},[]);return t.jsxs("div",{className:wt("group memo-wrapper","memos-"+e.id,e.pinned&&o.showPinned?"pinned":"",n),ref:C,children:[t.jsxs("div",{className:"memo-top-wrapper mb-1",children:[t.jsxs("div",{className:"w-full max-w-[calc(100%-20px)] flex flex-row justify-start items-center mr-1",children:[o.showCreator&&y&&t.jsxs(t.Fragment,{children:[t.jsx(qt,{to:`/u/${encodeURIComponent(rt(e.creator))}`,unstable_viewTransition:!0,children:t.jsx(qe,{title:"Creator",placement:"top",children:t.jsxs("span",{className:"flex flex-row justify-start items-center",children:[t.jsx(Po,{className:"!w-5 !h-5 mr-1",avatarUrl:y.avatarUrl}),t.jsx("span",{className:"text-sm text-gray-600 max-w-[8em] truncate dark:text-gray-400",children:y.nickname||y.username})]})})}),t.jsx(M.Dot,{className:"w-4 h-auto text-gray-400 dark:text-zinc-400"})]}),t.jsx("span",{className:"text-sm text-gray-400 select-none",onClick:E,children:g}),o.showPinned&&e.pinned&&t.jsxs(t.Fragment,{children:[t.jsx(M.Dot,{className:"w-4 h-auto text-gray-400 dark:text-zinc-400"}),t.jsx(qe,{title:"Pinned",placement:"top",children:t.jsx(M.Bookmark,{className:"w-4 h-auto text-amber-500"})})]})]}),t.jsxs("div",{className:"btns-container space-x-2",children:[t.jsx("div",{className:"w-auto hidden group-hover:flex flex-row justify-between items-center",children:o.showVisibility&&e.visibility!==We.PRIVATE&&t.jsx(t.Fragment,{children:t.jsx(qe,{title:s(`memo.visibility.${Ao(e.visibility).toLowerCase()}`),placement:"top",children:t.jsx("span",{children:t.jsx(Eo,{visibility:e.visibility})})})})}),!I&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"btn more-action-btn",children:t.jsx(M.MoreVertical,{className:"icon-img"})}),t.jsx("div",{className:"more-action-btns-wrapper",children:t.jsxs("div",{className:"more-action-btns-container min-w-[6em]",children:[o.showPinned&&t.jsxs("span",{className:"btn",onClick:B,children:[e.pinned?t.jsx(M.BookmarkMinus,{className:"w-4 h-auto mr-2"}):t.jsx(M.BookmarkPlus,{className:"w-4 h-auto mr-2"}),e.pinned?s("common.unpin"):s("common.pin")]}),t.jsxs("span",{className:"btn",onClick:h,children:[t.jsx(M.Edit3,{className:"w-4 h-auto mr-2"}),s("common.edit")]}),t.jsxs("span",{className:"btn",onClick:f,children:[t.jsx(M.Link,{className:"w-4 h-auto mr-2"}),s("common.mark")]}),t.jsxs("span",{className:"btn",onClick:()=>Dn(e),children:[t.jsx(M.Share,{className:"w-4 h-auto mr-2"}),s("common.share")]}),t.jsx(Gt,{className:"!my-1"}),t.jsxs("span",{className:"btn text-orange-500",onClick:R,children:[t.jsx(M.Archive,{className:"w-4 h-auto mr-2"}),s("common.archive")]}),t.jsxs("span",{className:"btn text-red-600",onClick:H,children:[t.jsx(M.Trash,{className:"w-4 h-auto mr-2"}),s("common.delete")]}),t.jsx(Gt,{className:"!my-1"}),t.jsx("div",{className:"w-full pl-3 pr-2 text-xs text-gray-400",children:t.jsxs("div",{className:"font-mono max-w-20 cursor-pointer truncate",onClick:w,children:["ID: ",e.name]})})]})})]})]})]}),t.jsx(to,{memoId:e.id,content:e.content,readonly:I,onClick:j},`${e.id}-${e.updateTime}`),t.jsx(Mo,{resources:e.resources}),t.jsx(Cn,{memo:e,relationList:k})]})},Yn=p.memo(Tn);export{Yn as M,Yo as O,Xn as T,vn as a,Cn as b,Io as c,Dn as s,kt as u};
