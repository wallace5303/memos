import{aB as X,ax as w,r as h,j as n,I as c,aw as $}from"./index-wLWO9-d2.js";import{c as p}from"./useResponsiveWidth-huLhTKBL.js";import{g as z}from"./CommonDialog-ZOWzLRrT.js";var A=/\s/;function R(e){for(var t=e.length;t--&&A.test(e.charAt(t)););return t}var F=/^\s+/;function B(e){return e&&e.slice(0,R(e)+1).replace(F,"")}var N=NaN,L=/^[-+]0x[0-9a-f]+$/i,Y=/^0b[01]+$/i,M=/^0o[0-7]+$/i,D=parseInt;function P(e){if(typeof e=="number")return e;if(X(e))return N;if(w(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=w(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=B(e);var r=Y.test(e);return r||M.test(e)?D(e.slice(2),r?2:8):L.test(e)?N:+e}var I=1/0,O=17976931348623157e292;function _(e){if(!e)return e===0?e:0;if(e=P(e),e===I||e===-I){var t=e<0?-1:1;return t*O}return e===e?e:0}function ae(e){var t=_(e),r=t%1;return t===t?r?t-r:t:0}const q=(e,t=!0)=>e.externalLink?e.externalLink:`${t?window.location.origin:""}/o/r/${e.name}`,H=e=>G(e.type)?"image/*":e.type.startsWith("video")?"video/*":e.type.startsWith("audio")?"audio/*":e.type.startsWith("text")?"text/*":e.type.startsWith("application/epub+zip")?"application/epub+zip":e.type.startsWith("application/pdf")?"application/pdf":e.type.includes("word")?"application/msword":e.type.includes("excel")?"application/msexcel":e.type.startsWith("application/zip")?"application/zip":e.type.startsWith("application/x-java-archive")?"application/x-java-archive":"application/octet-stream",G=e=>e.startsWith("image/")&&!U(e),U=e=>e==="image/vnd.adobe.photoshop"||e==="image/x-photoshop"||e==="image/photoshop",V=.5,J=5,K=.25,m={scale:1,originX:-1,originY:-1},Q=({destroy:e,imgUrls:t,initialIndex:r})=>{const[a,o]=h.useState(r),[i,l]=h.useState(m);let u=-1,d=-1;const j=()=>{e()},y=s=>{s.touches.length>1||(u=s.touches[0].clientX)},S=s=>{s.touches.length>1||(d=s.touches[0].clientX)},b=s=>{if(!(s.touches.length>1)){if(u>-1&&d>-1){const f=u-d;f>50?g():f<-50&&x()}d=-1,u=-1}},x=()=>{a>0?(l(m),o(a-1)):e()},g=()=>{a<t.length-1?(l(m),o(a+1)):e()},v=s=>{s.clientX<window.innerWidth/2?x():g()},k=s=>{const f=s.nativeEvent.offsetX,E=s.nativeEvent.offsetY,T=s.deltaY<0?1:-1,W=Math.max(V,Math.min(J,i.scale+T*K));l({...i,originX:f,originY:E,scale:W})},C={transform:`scale(${i.scale})`,transformOrigin:`${i.originX===-1?"center":`${i.originX}px`} ${i.originY===-1?"center":`${i.originY}px`}`};return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"btns-container",children:n.jsx("button",{className:"btn",onClick:j,children:n.jsx(c.X,{className:"icon-img"})})}),n.jsx("div",{className:"img-container",onClick:v,children:n.jsx("img",{style:C,src:t[a],onClick:s=>s.stopPropagation(),onTouchStart:y,onTouchMove:S,onTouchEnd:b,onWheel:k,decoding:"async",loading:"lazy"})})]})};function Z(e,t){z({className:"preview-image-dialog",dialogName:"preview-image-dialog"},Q,{imgUrls:Array.isArray(e)?e:[e],initialIndex:t||0})}const ee=e=>{const{children:t,className:r}=e,a=e.baseSide||"width",o=h.useRef(null);return h.useEffect(()=>{const i=()=>{if(o.current)if(a==="width"){const l=o.current.clientWidth;o.current.style.height=l+"px"}else{const l=o.current.clientHeight;o.current.style.width=l+"px"}};return i(),window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[]),n.jsx("div",{ref:o,className:`${[a==="width"?"w-full":"h-full",r??""].join(" ")}`,children:t})},te=e=>{const{resource:t}=e,r=H(t),a=q(t),o=p("w-full h-auto",e.className),i=e.strokeWidth,l=()=>{window.open(a)};if(r==="image/*")return n.jsx(ee,{className:p(o,"flex items-center justify-center overflow-clip"),children:n.jsx("img",{className:"min-w-full min-h-full object-cover border rounded dark:border-none",src:t.externalLink?a:a+"?thumbnail=1",onClick:()=>Z(a),decoding:"async",loading:"lazy"})});const u=()=>{switch(r){case"video/*":return n.jsx(c.FileVideo2,{strokeWidth:i,className:"w-full h-auto"});case"audio/*":return n.jsx(c.FileAudio,{strokeWidth:i,className:"w-full h-auto"});case"text/*":return n.jsx(c.FileText,{strokeWidth:i,className:"w-full h-auto"});case"application/epub+zip":return n.jsx(c.Book,{strokeWidth:i,className:"w-full h-auto"});case"application/pdf":return n.jsx(c.Book,{strokeWidth:i,className:"w-full h-auto"});case"application/msword":return n.jsx(c.FileEdit,{strokeWidth:i,className:"w-full h-auto"});case"application/msexcel":return n.jsx(c.SheetIcon,{strokeWidth:i,className:"w-full h-auto"});case"application/zip":return n.jsx(c.FileArchiveIcon,{onClick:l,strokeWidth:i,className:"w-full h-auto"});case"application/x-java-archive":return n.jsx(c.BinaryIcon,{strokeWidth:i,className:"w-full h-auto"});default:return n.jsx(c.File,{strokeWidth:i,className:"w-full h-auto"})}};return n.jsx("div",{onClick:l,className:p(o,"max-w-[4rem] opacity-50"),children:u()})},re=$.memo(te);export{re as R,ee as S,H as a,q as g,Z as s,ae as t};
